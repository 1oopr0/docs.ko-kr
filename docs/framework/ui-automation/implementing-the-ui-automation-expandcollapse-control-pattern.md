---
title: UI 자동화 ExpandCollapse 컨트롤 패턴 구현
description: UI 자동화의 ExpandCollapse 컨트롤 패턴에 대 한 구현 지침 및 규칙에 대해 알아봅니다. IExpandCollapseProvider을 구현 하는 방법을 알아봅니다.
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, ExpandCollapse control pattern
- ExpandCollapse control pattern
- control patterns, ExpandCollapse
ms.assetid: 1dbabb8c-0d68-47c1-a35e-1c01cb01af26
ms.openlocfilehash: 525b57816071ba2d879036676201a0506d1a29db
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/24/2020
ms.locfileid: "87165864"
---
# <a name="implementing-the-ui-automation-expandcollapse-control-pattern"></a><span data-ttu-id="98fa6-104">UI 자동화 ExpandCollapse 컨트롤 패턴 구현</span><span class="sxs-lookup"><span data-stu-id="98fa6-104">Implementing the UI Automation ExpandCollapse Control Pattern</span></span>

> [!NOTE]
> <span data-ttu-id="98fa6-105">이 설명서는 <xref:System.Windows.Automation> 네임스페이스에 정의된 관리되는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 클래스를 사용하려는 .NET Framework 개발자를 위한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="98fa6-106">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]에 대한 최신 정보는 [Windows 자동화 API: UI 자동화](/windows/win32/winauto/entry-uiauto-win32)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="98fa6-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="98fa6-107">이 항목에서는 속성, 메서드 및 이벤트에 대한 정보를 포함하여 <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>를 구현하기 위한 지침 및 규칙을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-107">This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>, including information about properties, methods, and events.</span></span> <span data-ttu-id="98fa6-108">추가 참조에 대한 링크는 개요의 끝에 나열되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-108">Links to additional references are listed at the end of the overview.</span></span>

<span data-ttu-id="98fa6-109"><xref:System.Windows.Automation.ExpandCollapsePattern> 컨트롤 패턴은 시각적으로 확장되어 더 많은 콘텐츠를 표시하거나 축소되어 콘텐츠를 숨기는 컨트롤을 지원하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-109">The <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span> <span data-ttu-id="98fa6-110">이 컨트롤 패턴을 구현하는 컨트롤의 예제를 보려면 [Control Pattern Mapping for UI Automation Clients](control-pattern-mapping-for-ui-automation-clients.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="98fa6-110">For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](control-pattern-mapping-for-ui-automation-clients.md).</span></span>

<a name="Implementation_Guidelines_and_Conventions"></a>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="98fa6-111">구현 지침 및 규칙</span><span class="sxs-lookup"><span data-stu-id="98fa6-111">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="98fa6-112">ExpandCollapse 컨트롤 패턴을 구현할 때는 다음 지침 및 규칙에 유의하세요.</span><span class="sxs-lookup"><span data-stu-id="98fa6-112">When implementing the ExpandCollapse control pattern, note the following guidelines and conventions:</span></span>

- <span data-ttu-id="98fa6-113">UI에 확장/축소 기능을 제공하는 자식 개체로 빌드된 집계 컨트롤은 <xref:System.Windows.Automation.ExpandCollapsePattern> 컨트롤 패턴을 지원해야 하지만 자식 요소는 그렇지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-113">Aggregate controls—built with child objects that provide the UI with expand/collapse functionality—must support the <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern whereas their child elements do not.</span></span> <span data-ttu-id="98fa6-114">예를 들어 콤보 상자 컨트롤은 목록 상자, 단추 및 편집 컨트롤 조합으로 빌드되지만 <xref:System.Windows.Automation.ExpandCollapsePattern>을 지원해야 하는 부모 콤보 상자일 뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-114">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the <xref:System.Windows.Automation.ExpandCollapsePattern>.</span></span>

  > [!NOTE]
  > <span data-ttu-id="98fa6-115">단, 개별 MenuItem 개체의 집계인 메뉴 컨트롤은 예외입니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-115">An exception is the menu control, which is an aggregate of individual MenuItem objects.</span></span> <span data-ttu-id="98fa6-116">MenuItem 개체는 <xref:System.Windows.Automation.ExpandCollapsePattern> 컨트롤 패턴을 지원할 수 있지만 부모 메뉴 컨트롤은 그렇지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-116">The MenuItem objects can support the <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern, but the parent Menu control cannot.</span></span> <span data-ttu-id="98fa6-117">트리 및 트리 항목 컨트롤에도 유사한 예외가 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-117">A similar exception applies to the Tree and Tree Item controls.</span></span>

- <span data-ttu-id="98fa6-118">컨트롤의 <xref:System.Windows.Automation.ExpandCollapseState> 가 <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>로 설정되어 있으면 모든 <xref:System.Windows.Automation.ExpandCollapsePattern> 기능이 컨트롤에 대해 비활성화되고 이 컨트롤 패턴을 사용하여 가져올 수 있는 유일한 정보는 <xref:System.Windows.Automation.ExpandCollapseState>입니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-118">When the <xref:System.Windows.Automation.ExpandCollapseState> of a control is set to <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>, any <xref:System.Windows.Automation.ExpandCollapsePattern> functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the <xref:System.Windows.Automation.ExpandCollapseState>.</span></span> <span data-ttu-id="98fa6-119">나중에 자식 개체를 추가하면 <xref:System.Windows.Automation.ExpandCollapseState> 가 변경되고 <xref:System.Windows.Automation.ExpandCollapsePattern> 기능이 활성화됩니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-119">If any child objects are subsequently added, the <xref:System.Windows.Automation.ExpandCollapseState> changes and <xref:System.Windows.Automation.ExpandCollapsePattern> functionality is activated.</span></span>

- <span data-ttu-id="98fa6-120"><xref:System.Windows.Automation.ExpandCollapseState> 는 직계 자식 개체의 표시 유형을 나타내며, 모든 하위 개체의 표시 유형을 나타내지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-120"><xref:System.Windows.Automation.ExpandCollapseState> refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>

- <span data-ttu-id="98fa6-121">확장 및 축소는 컨트롤 관련 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-121">Expand and Collapse functionality is control-specific.</span></span> <span data-ttu-id="98fa6-122">다음은 이 동작의 예입니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-122">The following are examples of this behavior.</span></span>

  - <span data-ttu-id="98fa6-123">Office 개인 메뉴는 세가지 상태의 MenuItem(<xref:System.Windows.Automation.ExpandCollapseState.Expanded>, <xref:System.Windows.Automation.ExpandCollapseState.Collapsed> 및 <xref:System.Windows.Automation.ExpandCollapseState.PartiallyExpanded>)이 될 수 있으며, 이때 컨트롤은 <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> 또는 <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> 가 호출될 때 적용할 상태를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-123">The Office Personal Menu can be a tri-state MenuItem (<xref:System.Windows.Automation.ExpandCollapseState.Expanded>, <xref:System.Windows.Automation.ExpandCollapseState.Collapsed> and <xref:System.Windows.Automation.ExpandCollapseState.PartiallyExpanded>) where the control specifies the state to adopt when an <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called.</span></span>

  - <span data-ttu-id="98fa6-124">TreeItem에서 <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> 를 호출하면 모든 하위 항목 또는 직계 자식만 표시될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-124">Calling <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> on a TreeItem may display all descendants or only immediate children.</span></span>

  - <span data-ttu-id="98fa6-125">컨트롤에서 <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> 또는 <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> 를 호출하여 하위 항목의 상태를 유지 관리하는 경우 상태 변경 이벤트가 아니라 표시 유형 변경 이벤트를 전송해야 합니다. 축소될 때 부모 컨트롤이 하위 항목의 상태를 유지 관리하지 않으면 컨트롤이 더 이상 표시되지 않는 모든 하위 항목을 삭제하고 삭제된 이벤트를 발생시킬 수 있습니다. 또는 각 하위 항목에 대해 <xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A> 를 변경하고 표시 유형 변경 이벤트를 발생시킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-125">If calling <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the <xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A> for each descendant and raise a visibility change event.</span></span>

- <span data-ttu-id="98fa6-126">탐색을 보장하려면 부모 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에 관계없이 개체를 적절한 표시 유형 상태로 <xref:System.Windows.Automation.ExpandCollapseState>트리에 배치하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-126">To guarantee navigation, it is desirable for an object to be in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (with appropriate visibility state) regardless of its parents <xref:System.Windows.Automation.ExpandCollapseState>.</span></span> <span data-ttu-id="98fa6-127">요청 시 생성되는 하위 항목의 경우 처음으로 표시된 다음이나 표시되는 동안만 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리에 나타날 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-127">If descendants are generated on demand, they may only appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree after being displayed for the first time or only while they are visible.</span></span>

<a name="Required_Members_for_the_IValueProvider_Interface"></a>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="98fa6-128">IExpandCollapseProvider에 필요한 멤버</span><span class="sxs-lookup"><span data-stu-id="98fa6-128">Required Members for IExpandCollapseProvider</span></span>

<span data-ttu-id="98fa6-129"><xref:System.Windows.Automation.Provider.IExpandCollapseProvider>를 구현하려면 다음과 같은 속성 및 메서드가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-129">The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>.</span></span>

|<span data-ttu-id="98fa6-130">필요한 멤버</span><span class="sxs-lookup"><span data-stu-id="98fa6-130">Required members</span></span>|<span data-ttu-id="98fa6-131">멤버 형식</span><span class="sxs-lookup"><span data-stu-id="98fa6-131">Member type</span></span>|<span data-ttu-id="98fa6-132">참고</span><span class="sxs-lookup"><span data-stu-id="98fa6-132">Notes</span></span>|
|----------------------|-----------------|-----------|
|<xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A>|<span data-ttu-id="98fa6-133">속성</span><span class="sxs-lookup"><span data-stu-id="98fa6-133">Property</span></span>|<span data-ttu-id="98fa6-134">없음</span><span class="sxs-lookup"><span data-stu-id="98fa6-134">None</span></span>|
|<xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A>|<span data-ttu-id="98fa6-135">메서드</span><span class="sxs-lookup"><span data-stu-id="98fa6-135">Method</span></span>|<span data-ttu-id="98fa6-136">없음</span><span class="sxs-lookup"><span data-stu-id="98fa6-136">None</span></span>|
|<xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A>|<span data-ttu-id="98fa6-137">메서드</span><span class="sxs-lookup"><span data-stu-id="98fa6-137">Method</span></span>|<span data-ttu-id="98fa6-138">없음</span><span class="sxs-lookup"><span data-stu-id="98fa6-138">None</span></span>|
|<xref:System.Windows.Automation.AutomationPropertyChangedEventHandler>|<span data-ttu-id="98fa6-139">이벤트</span><span class="sxs-lookup"><span data-stu-id="98fa6-139">Event</span></span>|<span data-ttu-id="98fa6-140">이 컨트롤에는 연결된 이벤트가 없습니다. 이 제네릭 대리자를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-140">This control has no associated events; use this generic delegate.</span></span>|

<a name="Exceptions"></a>

## <a name="exceptions"></a><span data-ttu-id="98fa6-141">예외</span><span class="sxs-lookup"><span data-stu-id="98fa6-141">Exceptions</span></span>

<span data-ttu-id="98fa6-142">공급자는 다음과 같은 예외를 throw해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="98fa6-142">Providers must throw the following exceptions.</span></span>

|<span data-ttu-id="98fa6-143">예외 종류</span><span class="sxs-lookup"><span data-stu-id="98fa6-143">Exception type</span></span>|<span data-ttu-id="98fa6-144">조건</span><span class="sxs-lookup"><span data-stu-id="98fa6-144">Condition</span></span>|
|--------------------|---------------|
|<xref:System.InvalidOperationException>|<span data-ttu-id="98fa6-145"><xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A>또는 <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> 이 호출 될 때가 호출 됩니다 <xref:System.Windows.Automation.ExpandCollapseState>  =  <xref:System.Windows.Automation.ExpandCollapseState.LeafNode> .</span><span class="sxs-lookup"><span data-stu-id="98fa6-145">Either <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called when the <xref:System.Windows.Automation.ExpandCollapseState> = <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>.</span></span>|

## <a name="see-also"></a><span data-ttu-id="98fa6-146">참조</span><span class="sxs-lookup"><span data-stu-id="98fa6-146">See also</span></span>

- [<span data-ttu-id="98fa6-147">UI 자동화 컨트롤 패턴 개요</span><span class="sxs-lookup"><span data-stu-id="98fa6-147">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="98fa6-148">UI 자동화 공급자의 컨트롤 패턴 지원</span><span class="sxs-lookup"><span data-stu-id="98fa6-148">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="98fa6-149">클라이언트용 UI 자동화 컨트롤 패턴</span><span class="sxs-lookup"><span data-stu-id="98fa6-149">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="98fa6-150">TreeWalker를 사용하여 UI 자동화 요소 간 탐색</span><span class="sxs-lookup"><span data-stu-id="98fa6-150">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="98fa6-151">UI 자동화 트리 개요</span><span class="sxs-lookup"><span data-stu-id="98fa6-151">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="98fa6-152">UI 자동화에서 캐싱 사용</span><span class="sxs-lookup"><span data-stu-id="98fa6-152">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)
