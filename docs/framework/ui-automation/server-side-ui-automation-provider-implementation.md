---
title: 서버 쪽 UI 자동화 공급자 구현
description: .NET에서 사용자 지정 컨트롤에 대 한 서버 쪽 UI 자동화 공급자를 구현 하는 방법에 대해 알아봅니다. WPF 및 비 WPF 요소에 대 한 구현이 다릅니다.
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: ea1b5e668e29d854233d4dde4c0e6152d591da97
ms.sourcegitcommit: 3824ff187947572b274b9715b60c11269335c181
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/17/2020
ms.locfileid: "84903898"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="b68e3-104">서버 쪽 UI 자동화 공급자 구현</span><span class="sxs-lookup"><span data-stu-id="b68e3-104">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="b68e3-105">이 설명서는 <xref:System.Windows.Automation> 네임스페이스에 정의된 관리되는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 클래스를 사용하려는 .NET Framework 개발자를 위한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="b68e3-106">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]에 대한 최신 정보는 [Windows 자동화 API: UI 자동화](/windows/win32/winauto/entry-uiauto-win32)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b68e3-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="b68e3-107">이 섹션에서는 사용자 지정 컨트롤에 대한 서버 쪽 UI 자동화 공급자를 구현하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-107">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="b68e3-108">WPF (Windows Presentation Foundation) 요소 및 비 WPF 요소 (예: Windows Forms에 대해 디자인 된 요소)에 대 한 구현은 근본적으로 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-108">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for Windows Forms) is fundamentally different.</span></span> <span data-ttu-id="b68e3-109">WPF 요소 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 는에서 파생 된 클래스를 통해에 대 한 지원을 제공 <xref:System.Windows.Automation.Peers.AutomationPeer> 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-109">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="b68e3-110">비 WPF 요소는 공급자 인터페이스의 구현을 통해 지원을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-110">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="b68e3-111">보안 고려사항</span><span class="sxs-lookup"><span data-stu-id="b68e3-111">Security Considerations</span></span>

<span data-ttu-id="b68e3-112">부분적 신뢰 환경에서 작동할 수 있도록 공급자를 작성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-112">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="b68e3-113">UIAutomationClient.dll은 부분적 신뢰 환경에서 실행되도록 구성되지 않았으므로, 공급자 코드가 해당 어셈블리를 참조해서는 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-113">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="b68e3-114">참조하는 경우에는 이 코드를 완전 신뢰 환경에서 실행할 수 있지만 부분적 신뢰 환경에서 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-114">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="b68e3-115">특히 UIAutomationClient.dll의 클래스에서 가져온 필드(예: <xref:System.Windows.Automation.AutomationElement>의 필드)를 사용하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-115">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="b68e3-116">대신, UIAutomationTypes.dll의 클래스(예: <xref:System.Windows.Automation.AutomationElementIdentifiers>)에서 가져온 해당 필드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-116">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="b68e3-117">Windows Presentation Foundation 요소를 사용한 공급자 구현</span><span class="sxs-lookup"><span data-stu-id="b68e3-117">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="b68e3-118">이 항목에 대한 자세한 내용은 [WPF 사용자 지정 컨트롤의 UI 자동화](../wpf/controls/ui-automation-of-a-wpf-custom-control.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b68e3-118">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="b68e3-119">비 WPF 요소를 사용한 공급자 구현</span><span class="sxs-lookup"><span data-stu-id="b68e3-119">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="b68e3-120">WPF 프레임 워크의 일부가 아니지만 관리 코드로 작성 된 사용자 지정 컨트롤 (대부분의 경우 Windows Forms 컨트롤)은 인터페이스를 구현 하 여에 대 한 지원을 제공 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-120">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are Windows Forms controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="b68e3-121">모든 요소는 다음 섹션의 첫 번째 표에 나온 인터페이스 중 하나 이상을 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-121">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="b68e3-122">또한 요소가 하나 이상의 컨트롤 패턴을 지원하는 경우 각 컨트롤 패턴에 대해 적절한 인터페이스를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-122">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="b68e3-123">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 공급자 프로젝트는 다음 어셈블리를 참조해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-123">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="b68e3-124">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="b68e3-124">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="b68e3-125">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="b68e3-125">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="b68e3-126">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="b68e3-126">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="b68e3-127">공급자 인터페이스</span><span class="sxs-lookup"><span data-stu-id="b68e3-127">Provider Interfaces</span></span>

<span data-ttu-id="b68e3-128">모든 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 공급자는 다음 인터페이스 중 하나를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-128">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="b68e3-129">인터페이스</span><span class="sxs-lookup"><span data-stu-id="b68e3-129">Interface</span></span>|<span data-ttu-id="b68e3-130">Description</span><span class="sxs-lookup"><span data-stu-id="b68e3-130">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="b68e3-131">컨트롤 패턴 및 속성에 대한 지원을 포함하여 창에서 호스트되는 간단한 제어용 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-131">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="b68e3-132"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple>에서 상속됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="b68e3-133">조각 내의 탐색, 포커스 설정, 요소의 경계 사각형 반환 등을 포함하여 복잡한 제어에 있는 요소에 대한 기능을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-133">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="b68e3-134"><xref:System.Windows.Automation.Provider.IRawElementProviderFragment>에서 상속됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-134">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="b68e3-135">지정된 좌표에 자식 요소 배치, 전체 컨트롤에 대한 포커스 상태 설정을 포함하여 복잡한 제어에 있는 루트 요소에 대한 기능을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-135">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="b68e3-136">다음 인터페이스는 추가된 기능을 제공하지만 반드시 구현할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-136">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="b68e3-137">인터페이스</span><span class="sxs-lookup"><span data-stu-id="b68e3-137">Interface</span></span>|<span data-ttu-id="b68e3-138">Description</span><span class="sxs-lookup"><span data-stu-id="b68e3-138">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="b68e3-139">공급자가 이벤트에 대한 요청을 추적할 수 있게 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-139">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="b68e3-140">조각의 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리 내에서 창 기반 요소의 위치 변경을 가능하게 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-140">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="b68e3-141"><xref:System.Windows.Automation.Provider> 네임스페이스의 다른 모든 인터페이스는 컨트롤 패턴을 지원하는 용도입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-141">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="b68e3-142">비 WPF 공급자에 대한 요구 사항</span><span class="sxs-lookup"><span data-stu-id="b68e3-142">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="b68e3-143">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]와 통신하려면 컨트롤이 다음과 같은 주요 기능 영역을 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-143">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="b68e3-144">기능</span><span class="sxs-lookup"><span data-stu-id="b68e3-144">Functionality</span></span>|<span data-ttu-id="b68e3-145">구현</span><span class="sxs-lookup"><span data-stu-id="b68e3-145">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="b68e3-146">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b68e3-146">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="b68e3-147">제어 창에 전송된 WM_GETOBJECT 메시지에 대한 응답으로, <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> 을 구현하는 개체(또는 파생된 인터페이스)를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-147">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="b68e3-148">조각의 경우, 이는 조각 루트에 대한 공급자여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-148">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="b68e3-149">속성 값 제공</span><span class="sxs-lookup"><span data-stu-id="b68e3-149">Provide property values</span></span>|<span data-ttu-id="b68e3-150"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> 를 구현하여 값을 제공하거나 재정의합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-150">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="b68e3-151">클라이언트에서 컨트롤을 조작할 수 있게 설정</span><span class="sxs-lookup"><span data-stu-id="b68e3-151">Enable the client to interact with the control</span></span>|<span data-ttu-id="b68e3-152"><xref:System.Windows.Automation.Provider.IInvokeProvider>와 같은 컨트롤 패턴을 지원하는 인터페이스를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-152">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="b68e3-153">이러한 패턴 공급자를 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>구현에서 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-153">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="b68e3-154">이벤트 발생</span><span class="sxs-lookup"><span data-stu-id="b68e3-154">Raise events</span></span>|<span data-ttu-id="b68e3-155"><xref:System.Windows.Automation.Provider.AutomationInteropProvider> 의 정적 메서드 중 하나를 호출하여 클라이언트가 수신할 수 있는 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-155">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="b68e3-156">조각 내에서 탐색 및 포커스를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-156">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="b68e3-157">조각 내의 각 요소에 대해 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> 를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-157">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="b68e3-158">(조각의 포함되지 않은 요소의 경우 필요 없습니다.)</span><span class="sxs-lookup"><span data-stu-id="b68e3-158">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="b68e3-159">조각 내 자식 요소의 포커스 및 위치를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-159">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="b68e3-160"><xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-160">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="b68e3-161">(조각 루트가 아닌 요소의 경우 필요 없습니다.)</span><span class="sxs-lookup"><span data-stu-id="b68e3-161">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="b68e3-162">비 WPF 공급자의 속성 값</span><span class="sxs-lookup"><span data-stu-id="b68e3-162">Property Values in Non-WPF Providers</span></span>

<span data-ttu-id="b68e3-163">사용자 지정 컨트롤에 대한[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 공급자는 자동화 시스템뿐만 아니라 클라이언트 애플리케이션에서도 사용할 수 있는 특정 속성을 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-163">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="b68e3-164">창에서 호스트되는 요소(HWND)의 경우 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에서는 기본 창 공급자에서 일부 속성을 검색할 수 있지만 다른 일부 속성은 사용자 지정 공급자에서 가져와야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-164">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="b68e3-165">HWND 기반 컨트롤에 대한 공급자는 일반적으로 다음 속성(필드 값으로 식별됨)을 제공할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-165">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="b68e3-166">간단한 요소나 창에서 호스트되는 조각 루트의 <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> 는 창에서 가져옵니다. 그러나 루트 아래의 조각 요소(예: 목록 상자에 있는 목록 항목)는 고유 식별자를 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="b68e3-167">자세한 내용은 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A> 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b68e3-167">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="b68e3-168"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>Windows Forms 컨트롤에서 호스트 되는 공급자에 대해를 반환 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="b68e3-169">이 경우 기본 창 공급자가 올바른 값을 검색하지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-169">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="b68e3-170"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> 는 일반적으로 호스트 공급자가 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-170">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="b68e3-171">예를 들어 사용자 지정 컨트롤이 <xref:System.Windows.Forms.Control>에서 파생된 경우 이름은 컨트롤의 `Text` 속성에서 파생됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-171">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="b68e3-172">예제 코드를 보려면 [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b68e3-172">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="b68e3-173">비 WPF 공급자의 이벤트</span><span class="sxs-lookup"><span data-stu-id="b68e3-173">Events in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="b68e3-174">공급자는 UI 상태 변경 시 이를 클라이언트 애플리케이션에 알리는 이벤트를 발생시켜야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-174">providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="b68e3-175">다음 메서드는 이벤트를 발생시키는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-175">The following methods are used to raise events.</span></span>

|<span data-ttu-id="b68e3-176">방법</span><span class="sxs-lookup"><span data-stu-id="b68e3-176">Method</span></span>|<span data-ttu-id="b68e3-177">설명</span><span class="sxs-lookup"><span data-stu-id="b68e3-177">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="b68e3-178">컨트롤 패턴에 의해 트리거되는 이벤트를 포함하여 다양한 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-178">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="b68e3-179">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 속성이 변경되면 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-179">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="b68e3-180">예를 들어 요소가 제거되거나 추가되는 등, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리가 변경되면 이벤트를 발생시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-180">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="b68e3-181">이벤트의 목적은 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]에서 발생하는 상황과 이 활동이 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 시스템 자체에서 트리거되는지 여부를 클라이언트에 알리는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-181">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="b68e3-182">예를 들어 <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> 로 식별되는 이벤트는 직접적인 사용자 입력을 통해서든 아니면 클라이언트 애플리케이션이 <xref:System.Windows.Automation.InvokePattern.Invoke%2A>를 호출해서든 상관없이 컨트롤이 호출될 때마다 발생해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-182">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="b68e3-183">성능을 최적화하기 위해 공급자는 선택적으로 이벤트를 발생시키거나 이벤트 수신을 등록한 클라이언트 애플리케이션이 없는 경우에는 이벤트를 전혀 발생시키지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-183">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="b68e3-184">최적화를 위해 다음 메서드가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-184">The following methods are used for optimization.</span></span>

|<span data-ttu-id="b68e3-185">방법</span><span class="sxs-lookup"><span data-stu-id="b68e3-185">Method</span></span>|<span data-ttu-id="b68e3-186">설명</span><span class="sxs-lookup"><span data-stu-id="b68e3-186">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="b68e3-187">이 정적 속성은 클라이언트 애플리케이션이 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 이벤트를 수신하도록 가입했는지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-187">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="b68e3-188">공급자가 조각 루트에 대해 이 인터페이스를 구현하면 클라이언트가 조각의 이벤트에 대해 이벤트 처리기를 등록하거나 등록 취소할 때 이에 대해 알림을 받을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-188">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="b68e3-189">비 WPF 공급자 탐색</span><span class="sxs-lookup"><span data-stu-id="b68e3-189">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="b68e3-190">창에서 호스트되는 사용자 지정 단추(HWND)와 같은 간단한 컨트롤의 공급자는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리 내의 탐색을 지원할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-190">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="b68e3-191">요소 및 요소 간 탐색은 호스트 창에 대한 기본 공급자가 처리하며, 이에 대해서는 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>구현에서 지정됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-191">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="b68e3-192">그러나 복잡한 사용자 지정 제어를 위한 공급자를 구현하는 경우에는 조각의 루트 노드와 해당 하위 항목 사이, 그리고 형제 노드 사이의 탐색을 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-192">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="b68e3-193">루트 이외의 조각 요소는 창에서 직접 호스트되지 않으며 기본 공급자가 이 요소에 대한 탐색을 지원할 수 없기 때문에 `null` 에서 <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>참조를 반환해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-193">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="b68e3-194">조각의 구조는 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>의 구현에 따라 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-194">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="b68e3-195">각 조각에서 가능한 각 방향에 대해, 이 메서드는 해당 방향에 있는 요소에 대한 공급자 개체를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-195">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="b68e3-196">해당 방향에 요소가 없는 경우 메서드는 `null` 참조를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-196">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="b68e3-197">조각 루트는 자식 요소에 대해서만 탐색을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-197">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="b68e3-198">예를 들어 방향이 <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>이면 목록 상자는 목록의 첫 번째 항목을 반환하고 방향이 <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>이면 마지막 항목을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-198">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="b68e3-199">조각 루트는 부모 또는 형제 항목 탐색을 지원하지 않습니다. 이 작업은 호스트 창 공급자에 의해 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-199">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="b68e3-200">조각의 루트가 아닌 요소는 부모뿐만 아니라 해당 형제 및 자식 항목에 대해서도 탐색을 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-200">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="b68e3-201">비 WPF 공급자 부모 재지정</span><span class="sxs-lookup"><span data-stu-id="b68e3-201">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="b68e3-202">팝업 창은 실제로 최상위 창이므로 기본적으로 데스크톱의 자식 항목으로 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리에 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-202">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="b68e3-203">그러나 많은 경우, 팝업 창은 논리적으로 다른 일부 컨트롤의 자식 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-203">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="b68e3-204">예를 들어 콤보 상자의 드롭다운 목록은 논리적으로 콤보 상자의 자식 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-204">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="b68e3-205">마찬가지로, 메뉴 팝업 창은 논리적으로 메뉴의 자식 항목입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-205">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="b68e3-206">에서는 팝업 창이 관련 컨트롤의 자식 항목으로 보이도록 팝업 창의 부모 재지정을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-206">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="b68e3-207">팝업 창의 부모를 다시 지정하려면</span><span class="sxs-lookup"><span data-stu-id="b68e3-207">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="b68e3-208">팝업 창에 대한 공급자를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-208">Create a provider for the pop-up window.</span></span> <span data-ttu-id="b68e3-209">그러려면 팝업 창의 클래스를 미리 알고 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-209">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="b68e3-210">해당 팝업에 대해 평소와 같이, 고유 권한이 있는 컨트롤처럼 모든 속성과 패턴을 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-210">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="b68e3-211"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> 에서 가져온 값을 반환하도록 <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>속성을 구현합니다. 여기서 매개 변수는 팝업 창의 창 핸들입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-211">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="b68e3-212">논리 부모에서 논리 자식으로, 그리고 형제 자식 사이에 탐색이 올바르게 처리되도록 팝업 창 및 해당 상위 항목에 대해 <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> 을 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-212">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="b68e3-213">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에서 팝업 창을 발견하면 탐색이 기본값에서 재정의된다는 것을 인식하며 데스크톱의 자식 항목으로 발견된 경우에는 팝업 창으로 건너뜁니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-213">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="b68e3-214">대신, 조각을 통해서만 노드에 도달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-214">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="b68e3-215">부모 재지정은 컨트롤이 클래스의 창을 호스트할 수 있는 경우에는 적합하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-215">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="b68e3-216">예를 들어 rebar는 모든 유형의 HWND를 밴드에서 호스트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-216">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="b68e3-217">이런 경우를 처리하기 위해 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 에서는 다음 섹션의 설명대로 다른 형식의 HWND 재배치를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-217">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="b68e3-218">비 WPF 공급자 위치 변경</span><span class="sxs-lookup"><span data-stu-id="b68e3-218">Non-WPF Provider Repositioning</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="b68e3-219">조각은 각각 창에 포함된 두 개 이상의 항목(HWND)을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-219">fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="b68e3-220">각 HWND에는 HWND를 이를 포함하는 HWND의 자식으로 간주하는 고유한 기본 공급자가 있기 때문에, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리는 기본적으로 조각에 있는 HWND를 부모 창의 자식 항목으로 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-220">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="b68e3-221">대부분의 경우 이것은 바람직한 동작이지만, 때로는 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]의 논리 구조와 일치하지 않기 때문에 혼란을 일으킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-221">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="b68e3-222">그 좋은 예가 rebar 컨트롤입니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-222">A good example of this is a rebar control.</span></span> <span data-ttu-id="b68e3-223">rebar에는 밴드가 있고, 각 밴드에는 도구 모음, 편집 상자, 콤보 상자와 같은 HWND 기반 컨트롤이 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-223">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="b68e3-224">rebar HWND에 대한 기본 창 공급자는 밴드 컨트롤 HWND를 자식으로 간주하고, rebar 공급자는 밴드를 자식으로 간주합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-224">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="b68e3-225">HWND 공급자 및 rebar 공급자는 함께 작업하며 각 자식 항목을 결합하기 때문에 밴드와 HWND 기반 컨트롤이 모두 rebar의 자식으로 나타납니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-225">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="b68e3-226">그러나 논리적으로는 밴드만 rebar의 자식으로 나타나야 하며 각 밴드 공급자는 포함된 컨트롤에 대한 기본 HWND 공급자와 연결되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-226">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="b68e3-227">이를 위해 rebar에 대한 조각 루트 공급자는 밴드는 나타내는 일련의 자식 항목을 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-227">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="b68e3-228">각 밴드에는 속성 및 패턴을 노출할 수 있는 단일 공급자가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-228">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="b68e3-229"><xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>구현에서 밴드 공급자는 <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>호출 후 컨트롤의 창 핸들에 전달하여 가져온 컨트롤 HWND에 대한 기본 창 공급자를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-229">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="b68e3-230">마지막으로, rebar에 대한 조각 루트 공급자는 <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> 인터페이스를 구현하고 <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> 구현에서 지정된 HWND에 포함된 컨트롤에 적절한 밴드 공급자를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b68e3-230">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="b68e3-231">참고 항목</span><span class="sxs-lookup"><span data-stu-id="b68e3-231">See also</span></span>

- [<span data-ttu-id="b68e3-232">UI 자동화 공급자 개요</span><span class="sxs-lookup"><span data-stu-id="b68e3-232">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="b68e3-233">서버 쪽 UI 자동화 공급자 노출</span><span class="sxs-lookup"><span data-stu-id="b68e3-233">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="b68e3-234">UI 자동화 공급자에서 속성 반환</span><span class="sxs-lookup"><span data-stu-id="b68e3-234">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="b68e3-235">UI 자동화 공급자에서 이벤트 발생</span><span class="sxs-lookup"><span data-stu-id="b68e3-235">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="b68e3-236">UI 자동화 조각 공급자에서 탐색 사용</span><span class="sxs-lookup"><span data-stu-id="b68e3-236">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="b68e3-237">UI 자동화 공급자의 컨트롤 패턴 지원</span><span class="sxs-lookup"><span data-stu-id="b68e3-237">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
