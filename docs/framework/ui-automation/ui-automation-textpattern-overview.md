---
title: UI 자동화 TextPattern 개요
description: UI 자동화에서 TextPattern 컨트롤 패턴에 대 한 개요를 읽습니다. 이 컨트롤 패턴은 형식 및 스타일을 포함 하 여 컨트롤의 텍스트 내용을 노출 합니다.
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, TextPattern class
- TextPattern class
- classes, TextPattern
ms.assetid: 41787927-df1f-4f4a-aba3-641662854fc4
ms.openlocfilehash: 986b601bbd212582c09c559a9bb22983ba59fa17
ms.sourcegitcommit: 40de8df14289e1e05b40d6e5c1daabd3c286d70c
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/22/2020
ms.locfileid: "86924671"
---
# <a name="ui-automation-textpattern-overview"></a><span data-ttu-id="bef5e-104">UI 자동화 TextPattern 개요</span><span class="sxs-lookup"><span data-stu-id="bef5e-104">UI Automation TextPattern Overview</span></span>

> [!NOTE]
> <span data-ttu-id="bef5e-105">이 설명서는 <xref:System.Windows.Automation> 네임스페이스에 정의된 관리되는 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 클래스를 사용하려는 .NET Framework 개발자를 위한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="bef5e-106">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]에 대한 최신 정보는 [Windows 자동화 API: UI 자동화](/windows/win32/winauto/entry-uiauto-win32)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="bef5e-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="bef5e-107">이 개요에서는 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 을 사용하여 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]이 지원되는 플랫폼에 있는 텍스트 컨트롤의 텍스트 콘텐츠(형식 및 스타일 특성 포함)를 노출하는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-107">This overview describes how to use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] to expose the textual content, including format and style attributes, of text controls in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-supported platforms.</span></span> <span data-ttu-id="bef5e-108">이러한 컨트롤에는 Microsoft .NET 프레임 워크 <xref:System.Windows.Controls.TextBox> 및 해당 Win32의 해당 항목을 포함 하지만이에 국한 되지 않습니다 <xref:System.Windows.Controls.RichTextBox> .</span><span class="sxs-lookup"><span data-stu-id="bef5e-108">These controls include, but are not limited to, the Microsoft .NET Framework <xref:System.Windows.Controls.TextBox> and <xref:System.Windows.Controls.RichTextBox> as well as their Win32 equivalents.</span></span>

<span data-ttu-id="bef5e-109">컨트롤의 텍스트 콘텐츠 노출은 텍스트 컨테이너의 내용을 텍스트 스트림으로 나타내는 <xref:System.Windows.Automation.TextPattern> 컨트롤 패턴을 사용하여 수행됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-109">Exposing the textual content of a control is accomplished through the use of the <xref:System.Windows.Automation.TextPattern> control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="bef5e-110">다시, <xref:System.Windows.Automation.TextPattern> 을 사용하려면 형식 및 스타일 특성을 노출하는 <xref:System.Windows.Automation.Text.TextPatternRange> 클래스를 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-110">In turn, <xref:System.Windows.Automation.TextPattern> requires the support of the <xref:System.Windows.Automation.Text.TextPatternRange> class to expose format and style attributes.</span></span> <span data-ttu-id="bef5e-111"><xref:System.Windows.Automation.Text.TextPatternRange>는 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> 및 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> 엔드포인트 컬렉션을 사용하여 텍스트 컨테이너의 연속 텍스트 범위나 여러 비연속 텍스트 범위를 나타내 <xref:System.Windows.Automation.TextPattern>을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-111"><xref:System.Windows.Automation.Text.TextPatternRange> supports <xref:System.Windows.Automation.TextPattern> by representing contiguous or multiple, disjoint text spans in a text container with a collection of <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> and <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> endpoints.</span></span> <span data-ttu-id="bef5e-112"><xref:System.Windows.Automation.Text.TextPatternRange> 는 선택, 비교, 검색 및 탐색 등의 기능을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-112"><xref:System.Windows.Automation.Text.TextPatternRange> supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!NOTE]
> <span data-ttu-id="bef5e-113"><xref:System.Windows.Automation.TextPattern> 클래스는 텍스트를 삽입하거나 수정할 수 있는 방법을 제공하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-113">The <xref:System.Windows.Automation.TextPattern> classes do not provide a means to insert or modify text.</span></span> <span data-ttu-id="bef5e-114">그러나 컨트롤에 따라 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> 또는 직접 키보드 입력을 통해이를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-114">However, depending on the control, this may be accomplished by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <xref:System.Windows.Automation.ValuePattern> or through direct keyboard input.</span></span> <span data-ttu-id="bef5e-115">예제는 [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) 을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="bef5e-115">See the [TextPattern Insert Text Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Accessibility/InsertText) for an example.</span></span>

<span data-ttu-id="bef5e-116">이 개요에 설명된 기능은 보조 기술 공급업체 및 최종 사용자에게 중요합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-116">The functionality described in this overview is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="bef5e-117">보조 기술은 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 를 사용하여 사용자에 대한 전체 텍스트 형식 정보를 수집하고 <xref:System.Windows.Automation.Text.TextUnit> (문자, 단어, 줄 또는 단락)별로 텍스트의 프로그래밍 방식 탐색 및 선택 기능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-117">Assistive technologies can use [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to gather complete text formatting information for the user and provide programmatic navigation and selection of text by <xref:System.Windows.Automation.Text.TextUnit> (character, word, line, or paragraph).</span></span>

<a name="UI_Automation_TextPattern_vs__Cicero"></a>

## <a name="ui-automation-textpattern-vs-text-services-framework"></a><span data-ttu-id="bef5e-118">UI 자동화 TextPattern과 텍스트 서비스 프레임워크 비교</span><span class="sxs-lookup"><span data-stu-id="bef5e-118">UI Automation TextPattern vs. Text Services Framework</span></span>

<span data-ttu-id="bef5e-119">TSF (텍스트 서비스 프레임 워크)는 데스크톱 및 응용 프로그램 내에서 자연어 서비스 및 고급 텍스트 입력을 사용할 수 있게 해 주는 간단 하 고 확장 가능한 시스템 프레임 워크입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-119">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and within applications.</span></span> <span data-ttu-id="bef5e-120">애플리케이션에서 해당 텍스트 저장소를 노출하는 인터페이스를 제공할 뿐 아니라 해당 텍스트 저장소에 대한 메타데이터를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-120">In addition to providing interfaces for applications to expose their text store it also supports metadata for that text store.</span></span>

<span data-ttu-id="bef5e-121">그러나 TSF는 컨텍스트 인식 시나리오에 입력을 삽입 해야 하는 응용 프로그램용으로 설계 된 반면, <xref:System.Windows.Automation.TextPattern> 은 화면 판독기 및 브라유 점자 장치용 텍스트 저장소에 최적화 된 액세스를 제공 하기 위한 읽기 전용 솔루션 (위에서 언급 한 제한 된 해결 방법 포함)입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-121">However, TSF was designed for applications that need to inject input into context-aware scenarios whereas <xref:System.Windows.Automation.TextPattern> is a read-only solution (with the limited workaround noted above) meant to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="bef5e-122">간단히 말해서, 텍스트 저장소에 대 한 읽기 전용 액세스가 필요한 액세스 가능한 기술에서는를 사용할 수 <xref:System.Windows.Automation.TextPattern> 있지만 컨텍스트 인식 입력의 경우 TSF의 더 복잡 한 기능이 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-122">In short, accessible technologies that require read-only access to a text store can use <xref:System.Windows.Automation.TextPattern>, but will need the more complex functionality of TSF for context-aware input.</span></span>

<a name="Control_Types"></a>

## <a name="control-types"></a><span data-ttu-id="bef5e-123">컨트롤 형식</span><span class="sxs-lookup"><span data-stu-id="bef5e-123">Control Types</span></span>

### <a name="text"></a><span data-ttu-id="bef5e-124">텍스트</span><span class="sxs-lookup"><span data-stu-id="bef5e-124">Text</span></span>

<span data-ttu-id="bef5e-125">텍스트 컨트롤은 화면에 텍스트 부분을 나타내는 기본 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-125">The Text control is the basic element representing a piece of text on the screen.</span></span>

<span data-ttu-id="bef5e-126">독립 실행형 텍스트 컨트롤을 폼의 레이블 또는 정적 텍스트로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-126">A standalone text control can be used as a label or static text on a form.</span></span> <span data-ttu-id="bef5e-127">텍스트 컨트롤을 <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> 또는 <xref:System.Windows.Automation.ControlType.DataItem>의 구조 내에 포함할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-127">Text controls can also be contained within the structure of a <xref:System.Windows.Automation.ControlType.ListItem>, <xref:System.Windows.Automation.ControlType.TreeItem> or <xref:System.Windows.Automation.ControlType.DataItem>.</span></span>

> [!NOTE]
> <span data-ttu-id="bef5e-128">텍스트 컨트롤이 트리의 콘텐츠 뷰에 표시 되지 않을 수 있습니다 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] ( [UI 자동화 트리 개요](ui-automation-tree-overview.md)참조).</span><span class="sxs-lookup"><span data-stu-id="bef5e-128">Text controls might not appear in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (see [UI Automation Tree Overview](ui-automation-tree-overview.md)).</span></span> <span data-ttu-id="bef5e-129">이는 텍스트 컨트롤이 대개 다른 컨트롤의 Name 속성을 통해 표시되기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-129">This is because text controls are often displayed through the Name property of another control.</span></span> <span data-ttu-id="bef5e-130">예를 들어 편집 컨트롤의 레이블을 지정하는 데 사용되는 텍스트는 편집 컨트롤의 Name 속성을 통해 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-130">For instance, the text that is used to label an Edit control is exposed through the Name property of the Edit control.</span></span> <span data-ttu-id="bef5e-131">편집 컨트롤이 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리의 콘텐츠 뷰에 있기 때문에 텍스트 요소 자체가 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 트리의 해당 뷰에 있을 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-131">Because the Edit control is in the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, it is not necessary for the text element itself to be in that view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="bef5e-132">콘텐츠 뷰에 표시되는 텍스트는 중복 정보가 아닌 텍스트뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-132">The only text that shows up in the content view is text that is not redundant information.</span></span> <span data-ttu-id="bef5e-133">이렇게 하면 보조 기술이 사용자에게 필요한 정보 부분만 신속하게 필터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-133">This enables any assistive technology to quickly filter only on the pieces of information that their users need.</span></span>

### <a name="edit"></a><span data-ttu-id="bef5e-134">편집</span><span class="sxs-lookup"><span data-stu-id="bef5e-134">Edit</span></span>

<span data-ttu-id="bef5e-135">편집 컨트롤을 통해 사용자는 텍스트 한 줄을 보고 편집할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-135">Edit controls enable a user to view and edit a single line of text.</span></span>

> [!NOTE]
> <span data-ttu-id="bef5e-136">특정 레이아웃 시나리오에서는 텍스트 한 줄이 줄 바꿈될 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-136">The single line of text may wrap in certain layout scenarios.</span></span>

### <a name="document"></a><span data-ttu-id="bef5e-137">문서</span><span class="sxs-lookup"><span data-stu-id="bef5e-137">Document</span></span>

<span data-ttu-id="bef5e-138">문서 컨트롤을 통해 사용자는 여러 텍스트 페이지를 탐색하고 정보를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-138">Document controls let a user navigate and obtain information from multiple pages of text.</span></span>

<a name="TextPattern_Client_API_s"></a>

## <a name="textpattern-client-apis"></a><span data-ttu-id="bef5e-139">TextPattern Client Api</span><span class="sxs-lookup"><span data-stu-id="bef5e-139">TextPattern Client APIs</span></span>

|||
|-|-|
|`System.Windows.Automation.TextPattern Class`|<span data-ttu-id="bef5e-140">[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 텍스트 모델에 대한 진입점입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-140">The entry point for the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] text model.</span></span><br /><br /> <span data-ttu-id="bef5e-141">또한 이 클래스에는 두 개의 <xref:System.Windows.Automation.TextPattern> 이벤트 수신기인 <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> 및 <xref:System.Windows.Automation.TextPattern.TextChangedEvent>가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-141">This class also contains the two <xref:System.Windows.Automation.TextPattern> event listeners, <xref:System.Windows.Automation.TextPattern.TextSelectionChangedEvent> and <xref:System.Windows.Automation.TextPattern.TextChangedEvent>.</span></span>|
|`System.Windows.Automation.Text.TextPatternRange Class`|<span data-ttu-id="bef5e-142"><xref:System.Windows.Automation.TextPattern>을 지원하는 텍스트 컨테이너 내의 텍스트 범위 표현입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-142">The representation of a span of text within a text container that supports <xref:System.Windows.Automation.TextPattern>.</span></span><br /><br /> <span data-ttu-id="bef5e-143">UI 자동화 클라이언트는 <xref:System.Windows.Automation.Text.TextPatternRange>를 사용하여 만든 텍스트 범위의 현재 유효성에 대해 주의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-143">UI Automation clients should be careful about the current validity of a text range created using <xref:System.Windows.Automation.Text.TextPatternRange>.</span></span> <span data-ttu-id="bef5e-144">텍스트 컨트롤의 원래 텍스트가 새 텍스트로 완전히 대체된 경우 현재 텍스트 범위는 유효하지 않게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-144">If the original text in the text control is completely replaced by new text, the current text range becomes invalid.</span></span> <span data-ttu-id="bef5e-145">그러나 원래 텍스트의 일부만 변경되고 내부 텍스트 컨트롤이 절대 문자 위치 지정 대신 앵커(또는 엔드포인트)로 텍스트 "포인터"를 관리하는 경우 텍스트 범위에 여전히 실행 가능성이 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-145">However, the text range may still have some viability if only part of the original text is changed and the underlying text control is managing its text "pointer" with anchors (or endpoints) rather than with absolute character positioning.</span></span><br /><br /> <span data-ttu-id="bef5e-146">클라이언트는 <xref:System.Windows.Automation.TextPattern.TextChangedEvent> 에서 작업 중인 텍스트 내용에 대한 변경 알림을 수신 대기할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-146">Clients can listen for a <xref:System.Windows.Automation.TextPattern.TextChangedEvent> for notification of any changes to the textual content they are working with.</span></span>|
|`System.Windows.Automation.AutomationTextAttribute Class`|<span data-ttu-id="bef5e-147">텍스트 범위의 형식 특성을 식별하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-147">Used to identify the formatting attributes of a text range.</span></span>|

<a name="TextPattern_Provider_API_s"></a>

## <a name="textpattern-provider-apis"></a><span data-ttu-id="bef5e-148">TextPattern 공급자 Api</span><span class="sxs-lookup"><span data-stu-id="bef5e-148">TextPattern Provider APIs</span></span>

<span data-ttu-id="bef5e-149">기본적으로 또는 <xref:System.Windows.Automation.TextPattern> 프록시를 통해 <xref:System.Windows.Automation.Provider.ITextProvider> 및 <xref:System.Windows.Automation.Provider.ITextRangeProvider> 인터페이스를 구현하여 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 을 지원하는 UI 요소나 컨트롤은 강력한 탐색 기능을 제공하는 것 외에도 포함된 텍스트에 대한 자세한 특성 정보를 노출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-149">UI elements or controls that support <xref:System.Windows.Automation.TextPattern> by implementing the <xref:System.Windows.Automation.Provider.ITextProvider> and <xref:System.Windows.Automation.Provider.ITextRangeProvider> interfaces, either natively or through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] proxies, are capable of exposing detailed attribute information for any text they contain in addition to providing robust navigational capabilities.</span></span>

<span data-ttu-id="bef5e-150">컨트롤이 특정 특성을 지원하지 않는 경우에는 <xref:System.Windows.Automation.TextPattern> 공급자가 일부 텍스트 특성을 지원하지 않아도 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-150">A <xref:System.Windows.Automation.TextPattern> provider does not have to support all text attributes if the control lacks support for any particular attributes.</span></span>

<span data-ttu-id="bef5e-151">컨트롤이 텍스트 영역 내에서 텍스트 선택이나 텍스트 커서(또는 시스템 캐럿) 배치를 지원하는 경우 <xref:System.Windows.Automation.TextPattern> 공급자가 <xref:System.Windows.Automation.TextPattern.GetSelection%2A> 및 <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> 함수를 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-151">A <xref:System.Windows.Automation.TextPattern> provider must support the <xref:System.Windows.Automation.TextPattern.GetSelection%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.Select%2A> functions if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="bef5e-152">컨트롤이 이 기능을 지원하지 않는 경우에는 이러한 메서드 중 하나를 지원하지 않아도 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-152">If the control does not support this functionality then it does not need to support either of these methods.</span></span> <span data-ttu-id="bef5e-153">그러나 컨트롤은 <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> 속성을 구현하여 지원하는 텍스트 선택 유형을 노출해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-153">However, the control must expose the type of text selection it supports by implementing the <xref:System.Windows.Automation.Provider.ITextProvider.SupportedTextSelection%2A> property.</span></span>

<span data-ttu-id="bef5e-154"><xref:System.Windows.Automation.TextPattern> 공급자는 항상 <xref:System.Windows.Automation.Text.TextUnit> 상수인 <xref:System.Windows.Automation.Text.TextUnit.Character> 및 <xref:System.Windows.Automation.Text.TextUnit.Document> 뿐 아니라 지원할 수 있는 다른 <xref:System.Windows.Automation.Text.TextUnit> 상수를 지원해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-154">A <xref:System.Windows.Automation.TextPattern> provider must always support the <xref:System.Windows.Automation.Text.TextUnit> constants <xref:System.Windows.Automation.Text.TextUnit.Character> and <xref:System.Windows.Automation.Text.TextUnit.Document> as well as any other <xref:System.Windows.Automation.Text.TextUnit> constants it is capable of supporting.</span></span>

> [!NOTE]
> <span data-ttu-id="bef5e-155">공급자는 <xref:System.Windows.Automation.Text.TextUnit> , <xref:System.Windows.Automation.Text.TextUnit> , <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>및 <xref:System.Windows.Automation.Text.TextUnit.Paragraph>순서로 지원되는 다음 가장 큰 <xref:System.Windows.Automation.Text.TextUnit.Page>로 지연하여 특정 <xref:System.Windows.Automation.Text.TextUnit.Document>에 대한 지원을 건너뛸 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-155">The provider may skip support for a specific <xref:System.Windows.Automation.Text.TextUnit> by deferring to the next largest <xref:System.Windows.Automation.Text.TextUnit> supported in the following order: <xref:System.Windows.Automation.Text.TextUnit.Character>, <xref:System.Windows.Automation.Text.TextUnit.Format>, <xref:System.Windows.Automation.Text.TextUnit.Word>, <xref:System.Windows.Automation.Text.TextUnit.Line>, <xref:System.Windows.Automation.Text.TextUnit.Paragraph>, <xref:System.Windows.Automation.Text.TextUnit.Page>, and <xref:System.Windows.Automation.Text.TextUnit.Document>.</span></span>

|||
|-|-|
|`ITextProvider Interface`|<span data-ttu-id="bef5e-156"><xref:System.Windows.Automation.TextPattern> 을 지원하는 메서드, 속성 및 특성을 클라이언트 애플리케이션에 노출합니다( <xref:System.Windows.Automation.Provider.ITextProvider>참조).</span><span class="sxs-lookup"><span data-stu-id="bef5e-156">Exposes methods, properties and attributes that support <xref:System.Windows.Automation.TextPattern> in client applications (see <xref:System.Windows.Automation.Provider.ITextProvider>).</span></span>|
|`ITextRangeProvider Interface`|<span data-ttu-id="bef5e-157">텍스트 공급자의 텍스트 범위를 나타냅니다( <xref:System.Windows.Automation.Provider.ITextRangeProvider>참조).</span><span class="sxs-lookup"><span data-stu-id="bef5e-157">Represents a span of text in a text provider (see <xref:System.Windows.Automation.Provider.ITextRangeProvider>).</span></span>|
|`System.Windows.Automation.TextPatternIdentifiers Class`|<span data-ttu-id="bef5e-158">텍스트 공급자의 식별자로 사용되는 값을 포함합니다( <xref:System.Windows.Automation.TextPatternIdentifiers>참조).</span><span class="sxs-lookup"><span data-stu-id="bef5e-158">Contains values that are used as identifiers for text providers (see <xref:System.Windows.Automation.TextPatternIdentifiers>).</span></span>|

<a name="Security"></a>

## <a name="security"></a><span data-ttu-id="bef5e-159">보안</span><span class="sxs-lookup"><span data-stu-id="bef5e-159">Security</span></span>

<span data-ttu-id="bef5e-160">아키텍처는 보안을 염두에 두면 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 설계 되었습니다 ( [UI 자동화 보안 개요](ui-automation-security-overview.md)참조).</span><span class="sxs-lookup"><span data-stu-id="bef5e-160">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] architecture was designed with security in mind (see [UI Automation Security Overview](ui-automation-security-overview.md)).</span></span> <span data-ttu-id="bef5e-161">그러나 이 개요에 설명된 TextPattern 클래스에는 특정 보안 고려 사항이 일부 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-161">However, the TextPattern classes described in this overview require some specific security considerations.</span></span>

- [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="bef5e-162">텍스트 공급자는 읽기 전용 인터페이스를 제공하며 컨트롤의 기존 텍스트를 변경하는 기능을 제공하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-162">text providers supply read-only interfaces and do not provide the ability to change the existing text in a control.</span></span>

- <span data-ttu-id="bef5e-163">UI 자동화 클라이언트는 완전히 "신뢰할 수 있는" 경우에만 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-163">UI Automation clients can only use [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] if they are fully "trusted".</span></span> <span data-ttu-id="bef5e-164">이러한 예로 알려져 있고 신뢰할 수 있는 애플리케이션만 실행할 수 있는 보호된 로그온 화면이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-164">An example of this would be the protected Logon Desktop, where only known and trusted applications can run.</span></span>

- <span data-ttu-id="bef5e-165">UI 자동화 공급자의 개발자는 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 을 통해 해당 컨트롤에 노출하도록 선택한 모든 정보가 기본적으로 공용이며 다른 코드에서 완전히 액세스할 수 있음을 알아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-165">Developers of UI Automation providers should be aware that all information they choose to expose in their controls through [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] is essentially public and fully accessible by other code.</span></span> [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="bef5e-166">에서 UI 자동화 클라이언트를 신뢰할 수 있는지 확인하지 않으므로 UI 자동화 공급자는 보호된 콘텐츠나 중요한 텍스트 정보(예: 암호 필드)를 노출하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-166">makes no effort to determine the trustworthiness of any UI Automation client and therefore the UI Automation provider should not expose protected content or sensitive textual information (such as password fields).</span></span>

- <span data-ttu-id="bef5e-167">Windows Vista에 대 한 보안의 가장 중요 한 변경 사항 중 하나는 일반적으로 최소 권한 (또는 제한 된) 사용자 계정 (LUA) 및 UI 권한 수준 격리 (UIPI)와 같은 기술을 포함 하는 "보안 입력" 이라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-167">One of the most significant changes in security for Windows Vista is broadly referred to as "Secure Input" which encompasses technologies such as Least-privileged (or Limited) User Accounts (LUA) and UI Privilege Level Isolation (UIPI).</span></span>

  - <span data-ttu-id="bef5e-168">UIPI는 프로그램이 보다 "권한 있는” 다른 프로그램을 제어 및/또는 모니터링할 수 없도록 차단하여 사용자 입력을 스푸핑하는 크로스 프로세스 창 메시지 공격을 방지합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-168">UIPI prevents one program from controlling and/or monitoring another more "privileged" program, preventing cross-process window message attacks that spoof user input.</span></span>

  - <span data-ttu-id="bef5e-169">LUA는 Administrators 그룹의 사용자가 실행하는 애플리케이션의 권한에 제한을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-169">LUA sets limits on the privileges of applications being run by users in the Administrators group.</span></span> <span data-ttu-id="bef5e-170">애플리케이션에 관리자 권한이 반드시 필요한 것은 아니며 필요한 최소 권한으로 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-170">Applications won't necessarily have administrator privileges, but will instead run with the least privileges necessary.</span></span> <span data-ttu-id="bef5e-171">결과적으로 LUA 시나리오에서는 몇 가지 제한 사항이 적용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-171">As a consequence, there may be some restrictions enforced in LUA scenarios.</span></span> <span data-ttu-id="bef5e-172">가장 주목할 만한 사항은 문자열 잘림(TextPattern 문자열 포함)입니다. 이 경우 애플리케이션을 사용할 수 없게 되는 지점까지 강제로 메모리를 할당하지 않아도 되도록 관리자 수준 애플리케이션에서 검색되는 문자열의 크기를 제한해야 할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-172">Most notably string truncation (including TextPattern strings), where it may be necessary to limit the size of strings being retrieved from administrator-level applications so they aren't forced to allocate memory to the point of disabling the application.</span></span>

<a name="Performance"></a>

## <a name="performance"></a><span data-ttu-id="bef5e-173">성능</span><span class="sxs-lookup"><span data-stu-id="bef5e-173">Performance</span></span>

<span data-ttu-id="bef5e-174">TextPattern은 대부분의 기능에 크로스 프로세스 호출을 사용하므로 콘텐츠를 처리할 때 성능을 향상시키기 위한 캐싱 메커니즘을 제공하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-174">Because TextPattern relies on cross-process calls for most of its functionality, it does not provide a caching mechanism to improve performance when processing content.</span></span> <span data-ttu-id="bef5e-175">이는 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 또는 <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> 메서드를 사용하여 액세스할 수 있는 <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> 의 컨트롤 패턴과는 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-175">This is unlike other control patterns in [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] that can be accessed using the <xref:System.Windows.Automation.AutomationElement.GetCachedPattern%2A> or <xref:System.Windows.Automation.AutomationElement.TryGetCachedPattern%2A> methods.</span></span>

<span data-ttu-id="bef5e-176">성능 향상을 위한 한 가지 방법은 <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>를 사용하여 UI 자동화 클라이언트가 적절한 크기의 텍스트 블록을 검색하도록 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-176">One tactic for improving performance is by making sure UI Automation clients attempt to retrieve moderately-sized blocks of text using <xref:System.Windows.Automation.Text.TextPatternRange.GetText%2A>.</span></span> <span data-ttu-id="bef5e-177">예를 들어 GetText(1) 호출은 각 문자에 대한 크로스 프로세스 적중을 발생시키고 반면 GetText(-1) 호출은 하나의 크로스 프로세스 적중을 발생시키지만 텍스트 공급자 크기에 따라 대기 시간이 높을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-177">For example, GetText(1) calls will incur cross-process hits for each character whereas one GetText(-1) call will incur one cross-process hit, but can have high latency depending on the size of the text provider.</span></span>

<a name="Glossary"></a>

## <a name="textpattern-terminology"></a><span data-ttu-id="bef5e-178">TextPattern 용어</span><span class="sxs-lookup"><span data-stu-id="bef5e-178">TextPattern Terminology</span></span>

<span data-ttu-id="bef5e-179">**특성도**</span><span class="sxs-lookup"><span data-stu-id="bef5e-179">**Attribute**</span></span>\
<span data-ttu-id="bef5e-180">텍스트 범위의 형식 특성(예: <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> 또는 <xref:System.Windows.Automation.TextPattern.FontNameAttribute>)입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-180">A formatting characteristic of a text range (for example, <xref:System.Windows.Automation.TextPattern.IsItalicAttribute> or <xref:System.Windows.Automation.TextPattern.FontNameAttribute>).</span></span>

<span data-ttu-id="bef5e-181">**중복 제거 범위**</span><span class="sxs-lookup"><span data-stu-id="bef5e-181">**Degenerate Range**</span></span>\
<span data-ttu-id="bef5e-182">중복 제거 범위는 비어 있거나 0자 텍스트 범위입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-182">A degenerate range is an empty or zero-character text range.</span></span> <span data-ttu-id="bef5e-183">TextPattern 컨트롤 패턴의 목적을 위해 텍스트 삽입 지점(또는 시스템 캐럿)은 중복 제거 범위로 간주됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-183">For the purposes of the TextPattern control pattern, the text insertion point (or system caret) is considered a degenerate range.</span></span> <span data-ttu-id="bef5e-184">선택한 텍스트가 없는 경우 <xref:System.Windows.Automation.TextPattern.GetSelection%2A>은 중복 제거 범위를 텍스트 삽입 지점에 반환하고 <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A>는 중복 제거 범위를 시작 엔드포인트로 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-184">If no text is selected, <xref:System.Windows.Automation.TextPattern.GetSelection%2A> would return a degenerate range at the text insertion point and <xref:System.Windows.Automation.TextPattern.RangeFromPoint%2A> would return a degenerate range as its starting endpoint.</span></span> <span data-ttu-id="bef5e-185">텍스트 공급자가 지정된 조건과 일치하는 텍스트 범위를 찾을 수 없는 경우<xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> 및 <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> 에서 중복 제거 범위를 반환할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-185"><xref:System.Windows.Automation.TextPattern.RangeFromChild%2A> and <xref:System.Windows.Automation.TextPattern.GetVisibleRanges%2A> may return degenerate ranges when the text provider cannot find any text ranges that match the given condition.</span></span> <span data-ttu-id="bef5e-186">이 중복 제거 범위는 텍스트 공급자 내에서 시작 엔드포인트로 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-186">This degenerate range can be used as a starting endpoint within the text provider.</span></span> <span data-ttu-id="bef5e-187"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A>및는 <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> null 참조 ( `Nothing` Microsoft Visual Basic .net)를 반환 하 여 검색 된 범위와 중복 제거 범위가 혼동 되지 않도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-187"><xref:System.Windows.Automation.Text.TextPatternRange.FindText%2A> and <xref:System.Windows.Automation.Text.TextPatternRange.FindAttribute%2A> return a null reference (`Nothing` in Microsoft Visual Basic .NET) to avoid confusion with a discovered range versus a degenerate range.</span></span>

<span data-ttu-id="bef5e-188">**포함 개체**</span><span class="sxs-lookup"><span data-stu-id="bef5e-188">**Embedded Object**</span></span>\
<span data-ttu-id="bef5e-189">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 텍스트 모델에는 두 가지 유형의 포함 개체가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-189">There are two types of embedded objects in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text model.</span></span> <span data-ttu-id="bef5e-190">하이퍼링크 또는 테이블과 같은 텍스트 기반 콘텐츠 요소와 이미지 및 단추와 같은 컨트롤 요소로 구성됩니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-190">They consist of text-based content elements such as hyperlinks or tables, and control elements such as images and buttons.</span></span> <span data-ttu-id="bef5e-191">자세한 내용은 [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="bef5e-191">For more detailed information, see [Access Embedded Objects Using UI Automation](access-embedded-objects-using-ui-automation.md).</span></span>

<span data-ttu-id="bef5e-192">**끝점만**</span><span class="sxs-lookup"><span data-stu-id="bef5e-192">**Endpoint**</span></span>\
<span data-ttu-id="bef5e-193">텍스트 컨테이너 내에서 텍스트 범위의 절대 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> 또는 <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> 지점입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-193">The absolute <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.Start> or <xref:System.Windows.Automation.Text.TextPatternRangeEndpoint.End> point of a text range within a text container.</span></span>

<span data-ttu-id="bef5e-194">![TextPatternRangeEndpoints &#40;시작 및 종료&#41; 합니다.](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span><span class="sxs-lookup"><span data-stu-id="bef5e-194">![TextPatternRangeEndpoints &#40;start and end&#41;.](./media/uia-textpattern-endpoints.PNG "UIA_TextPattern_Endpoints")</span></span>
<span data-ttu-id="bef5e-195">다음은 시작점과 끝점 집합을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-195">The following illustrates a set of start and end points.</span></span>

<span data-ttu-id="bef5e-196">**TextRange**</span><span class="sxs-lookup"><span data-stu-id="bef5e-196">**TextRange**</span></span>\
<span data-ttu-id="bef5e-197">연결된 모든 특성 및 기능을 포함하여 시작점과 끝점을 사용한 텍스트 컨테이너 내의 텍스트 범위에 대한 표현입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-197">A representation of a span of text, with start and end points, in a text container including all associated attributes and functionality.</span></span>

<xref:System.Windows.Automation.Text.TextUnit>\
<span data-ttu-id="bef5e-198">텍스트 범위의 논리적 세그먼트를 탐색하는 데 사용되는 미리 정의된 텍스트 단위(문자, 단어, 줄 또는 단락)입니다.</span><span class="sxs-lookup"><span data-stu-id="bef5e-198">A pre-defined unit of text (character, word, line, or paragraph) used for navigating through logical segments of a text range.</span></span>

## <a name="see-also"></a><span data-ttu-id="bef5e-199">추가 정보</span><span class="sxs-lookup"><span data-stu-id="bef5e-199">See also</span></span>

- [<span data-ttu-id="bef5e-200">클라이언트용 UI 자동화 컨트롤 패턴</span><span class="sxs-lookup"><span data-stu-id="bef5e-200">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="bef5e-201">UI 자동화 컨트롤 패턴 개요</span><span class="sxs-lookup"><span data-stu-id="bef5e-201">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="bef5e-202">UI 자동화 트리 개요</span><span class="sxs-lookup"><span data-stu-id="bef5e-202">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="bef5e-203">UI 자동화에서 캐싱 사용</span><span class="sxs-lookup"><span data-stu-id="bef5e-203">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)
- [<span data-ttu-id="bef5e-204">UI 자동화 공급자의 컨트롤 패턴 지원</span><span class="sxs-lookup"><span data-stu-id="bef5e-204">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="bef5e-205">UI 자동화 클라이언트에 대한 컨트롤 패턴 매핑</span><span class="sxs-lookup"><span data-stu-id="bef5e-205">Control Pattern Mapping for UI Automation Clients</span></span>](control-pattern-mapping-for-ui-automation-clients.md)
- [<span data-ttu-id="bef5e-206">텍스트 서비스 프레임워크 비교</span><span class="sxs-lookup"><span data-stu-id="bef5e-206">Text Services Framework</span></span>](/windows/desktop/api/_tsf/)
