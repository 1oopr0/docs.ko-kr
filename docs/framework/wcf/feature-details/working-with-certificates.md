---
title: 인증서 사용
description: X.509 digital certificate 기능 및 WCF에서 이러한 기능을 사용 하는 방법에 대해 알아봅니다. 이 문서의 리소스에서는 이러한 개념을 자세히 설명할 수 있습니다.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- certificates [WCF]
ms.assetid: 6ffb8682-8f07-4a45-afbb-8d2487e9dbc3
ms.openlocfilehash: 8090e84b33e2a6f442d387c7012e6ccdc2900dd1
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/23/2020
ms.locfileid: "85246404"
---
# <a name="working-with-certificates"></a><span data-ttu-id="58e87-104">인증서 사용</span><span class="sxs-lookup"><span data-stu-id="58e87-104">Working with Certificates</span></span>

<span data-ttu-id="58e87-105">WCF(Windows Communication Foundation) 보안을 프로그래밍하려면 일반적으로 X.509 디지털 인증서를 사용하여 클라이언트 및 서버를 인증하고, 암호화하고, 메시지에 디지털 서명합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-105">To program Windows Communication Foundation (WCF) security, X.509 digital certificates are commonly used to authenticate clients and servers, encrypt, and digitally sign messages.</span></span> <span data-ttu-id="58e87-106">이 항목에서는 X.509 디지털 인증서 기능과 WCF에서 인증서 기능을 사용하는 방법을 간략하게 설명하며, 이러한 개념을 자세히 설명하거나 WCF 및 인증서를 사용하여 일반 작업을 수행하는 방법을 보여 주는 항목에 대한 링크를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-106">This topic briefly explains X.509 digital certificate features and how to use them in WCF, and includes links to topics that explain these concepts further or that show how to accomplish common tasks using WCF and certificates.</span></span>

<span data-ttu-id="58e87-107">간단히 말해서 디지털 인증서는 공개 키 암호화 사용을 통해 전자 트랜잭션에 참여하는 각각의 상대방에 대해 유효성을 확인하고 인증하는 디지털 인증서, 인증 기관 및 기타 등록 기관의 시스템인 PKI(*공개 키 인프라*)의 일부입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-107">In brief, a digital certificate is a part of a *public key infrastructure* (PKI), which is a system of digital certificates, certificate authorities, and other registration authorities that verify and authenticate the validity of each party involved in an electronic transaction through the use of public key cryptography.</span></span> <span data-ttu-id="58e87-108">인증 기관은 인증서를 발급하며 각 인증서에는 *주체*(인증서가 발급되는 엔터티), 유효 날짜(인증서의 유효 기간), 발급자(인증서를 발급한 엔터티), 공개 키 등과 같은 데이터를 포함하는 필드 집합이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-108">A certification authority issues certificates and each certificate has a set of fields that contain data, such as *subject* (the entity to which the certificate is issued), validity dates (when the certificate is valid), issuer (the entity that issued the certificate), and a public key.</span></span> <span data-ttu-id="58e87-109">WCF에서 이러한 각 속성은 <xref:System.IdentityModel.Claims.Claim>으로 처리되며, 각 클레임은 ID와 권한의 두 가지 형식으로 세분화됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-109">In WCF, each of these properties is processed as a <xref:System.IdentityModel.Claims.Claim>, and each claim is further divided into two types: identity and right.</span></span> <span data-ttu-id="58e87-110">X.509 인증서에 대한 자세한 내용은[X.509 공개 키 인증서](/windows/desktop/SecCertEnroll/about-x-509-public-key-certificates)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-110">For more information about X.509 certificates see [X.509 Public Key Certificates](/windows/desktop/SecCertEnroll/about-x-509-public-key-certificates).</span></span> <span data-ttu-id="58e87-111">WCF에서 클레임 및 권한 부여에 대한 자세한 내용은 [ID 모델을 사용하여 클레임 및 권한 부여 관리](managing-claims-and-authorization-with-the-identity-model.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-111">For more information about Claims and Authorization in WCF see [Managing Claims and Authorization with the Identity Model](managing-claims-and-authorization-with-the-identity-model.md).</span></span> <span data-ttu-id="58e87-112">PKI 구현에 대 한 자세한 내용은 [Windows Server 2012 R2 Active Directory 인증서 서비스를 사용 하는 엔터프라이즈 pki](https://docs.microsoft.com/archive/blogs/yungchou/enterprise-pki-with-windows-server-2012-r2-active-directory-certificate-services-part-1-of-2)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-112">For more information about implementing a PKI, see [Enterprise PKI with Windows Server 2012 R2 Active Directory Certificate Services](https://docs.microsoft.com/archive/blogs/yungchou/enterprise-pki-with-windows-server-2012-r2-active-directory-certificate-services-part-1-of-2).</span></span>

<span data-ttu-id="58e87-113">인증서의 기본 기능은 인증서 소유자의 ID를 다른 엔터티에 인증하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-113">The primary function of a certificate is to authenticate the identity of the owner of the certificate to others.</span></span> <span data-ttu-id="58e87-114">인증서는 소유자의 *퍼블릭 키*를 포함하고, 소유자는 프라이빗 키를 보유합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-114">A certificate contains the *public key* of the owner, while the owner retains the private key.</span></span> <span data-ttu-id="58e87-115">공개 키를 사용하여 인증서 소유자에게 보내는 메시지를 암호화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-115">The public key can be used to encrypt messages sent to the owner of the certificate.</span></span> <span data-ttu-id="58e87-116">소유자만 프라이빗 키에 액세스할 수 있으므로 소유자만이 해당 메시지를 해독할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-116">Only the owner has access to the private key, so only the owner can decrypt those messages.</span></span>

<span data-ttu-id="58e87-117">인증서는 인증 기관에서 발급해야 합니다. 인증 기관이 인증서의 타사 발급자인 경우도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-117">Certificates must be issued by a certification authority, which is often a third-party  issuer of certificates.</span></span> <span data-ttu-id="58e87-118">Windows 도메인의 경우 도메인에서 컴퓨터에 인증서를 발급하는 데 사용할 수 있는 인증 기관이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-118">On a Windows domain, a certification authority is included that can be used to issue certificates to computers on the domain.</span></span>

## <a name="viewing-certificates"></a><span data-ttu-id="58e87-119">인증서 보기</span><span class="sxs-lookup"><span data-stu-id="58e87-119">Viewing Certificates</span></span>

<span data-ttu-id="58e87-120">인증서로 작업하려면 인증서를 표시하여 해당 속성을 검사해야 하는 경우가 종종 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-120">To work with certificates, it is often necessary to view them and examine their properties.</span></span> <span data-ttu-id="58e87-121">이 작업은 MMC(Microsoft Management Console) 스냅인 도구를 사용하여 쉽게 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-121">This is easily done with the Microsoft Management Console (MMC) snap-in tool.</span></span> <span data-ttu-id="58e87-122">자세한 내용은 [방법: MMC 스냅인을 사용하여 인증서 보기](how-to-view-certificates-with-the-mmc-snap-in.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-122">For more information, see [How to: View Certificates with the MMC Snap-in](how-to-view-certificates-with-the-mmc-snap-in.md).</span></span>

## <a name="certificate-stores"></a><span data-ttu-id="58e87-123">인증서 저장소</span><span class="sxs-lookup"><span data-stu-id="58e87-123">Certificate Stores</span></span>

<span data-ttu-id="58e87-124">인증서는 저장소에 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-124">Certificates are found in stores.</span></span> <span data-ttu-id="58e87-125">하위 저장소로 세분화되는 두 가지 주 저장소 위치가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-125">Two major store locations exist that are further divided into sub-stores.</span></span> <span data-ttu-id="58e87-126">컴퓨터의 관리자는 MMC 스냅인 도구를 사용하여 두 주 저장소를 모두 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-126">If you are the administrator on a computer, you can view both major stores by using the MMC snap-in tool.</span></span> <span data-ttu-id="58e87-127">관리자가 아닌 사용자는 현재 사용자 저장소만 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-127">Non-administrators can view only the current user store.</span></span>

- <span data-ttu-id="58e87-128">**로컬 컴퓨터 저장소**.</span><span class="sxs-lookup"><span data-stu-id="58e87-128">**The local machine store**.</span></span> <span data-ttu-id="58e87-129">여기에는 ASP.NET과 같은 컴퓨터 프로세스에서 액세스 하는 인증서가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-129">This contains the certificates accessed by machine processes, such as ASP.NET.</span></span> <span data-ttu-id="58e87-130">클라이언트에 서버를 인증하는 인증서를 저장하려면 이 위치를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-130">Use this location to store certificates that authenticate the server to clients.</span></span>

- <span data-ttu-id="58e87-131">**현재 사용자 저장소**.</span><span class="sxs-lookup"><span data-stu-id="58e87-131">**The current user store**.</span></span> <span data-ttu-id="58e87-132">대화형 애플리케이션은 일반적으로 컴퓨터의 현재 사용자에 대한 인증서를 여기에 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-132">Interactive applications typically place certificates here for the computer's current user.</span></span> <span data-ttu-id="58e87-133">클라이언트 애플리케이션을 만들 경우 일반적으로 서비스에 사용자를 인증하는 인증서를 이 위치에 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-133">If you are creating a client application, this is where you typically place certificates that authenticate a user to a service.</span></span>

<span data-ttu-id="58e87-134">이러한 두 저장소는 하위 저장소로 세분화됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-134">These two stores are further divided into sub-stores.</span></span> <span data-ttu-id="58e87-135">WCF로 프로그래밍할 때 가장 중요한 하위 저장소는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-135">The most important of these when programming with WCF include:</span></span>

- <span data-ttu-id="58e87-136">**신뢰할 수 있는 루트 인증 기관**.</span><span class="sxs-lookup"><span data-stu-id="58e87-136">**Trusted Root Certification Authorities**.</span></span> <span data-ttu-id="58e87-137">이 저장소에 있는 인증서를 사용하여 인증서 체인을 만들 수 있습니다. 이러한 인증서 체인은 이 저장소에 있는 인증서 인증 기관으로 다시 추적될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-137">You can use the certificates in this store to create a chain of certificates, which can be traced back to a certification authority certificate in this store.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="58e87-138">로컬 컴퓨터는 인증서를 신뢰할 수 있는 타사 인증 기관에서 가져오지 않았더라도 이 저장소에 있는 모든 인증서를 암시적으로 신뢰합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-138">The local computer implicitly trusts any certificate placed in this store, even if the certificate does not come from a trusted third-party certification authority.</span></span> <span data-ttu-id="58e87-139">따라서 발급자를 완전히 신뢰하고 결과를 이해하는 경우가 아니면 이 저장소에 인증서를 저장하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="58e87-139">For this reason, do not place any certificate into this store unless you fully trust the issuer and understand the consequences.</span></span>

- <span data-ttu-id="58e87-140">**개인**.</span><span class="sxs-lookup"><span data-stu-id="58e87-140">**Personal**.</span></span> <span data-ttu-id="58e87-141">이 저장소는 컴퓨터 사용과 연관된 인증서에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-141">This store is used for certificates associated with a user of a computer.</span></span> <span data-ttu-id="58e87-142">일반적으로 이 저장소는 신뢰할 수 있는 루트 인증 기관 저장소에 있는 인증 기관 인증서 중 하나에서 발급한 인증서에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-142">Typically this store is used for certificates issued by one of the certification authority certificates found in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="58e87-143">또한 여기에 있는 인증서는 애플리케이션에서 자체 발급하고 신뢰할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-143">Alternatively, a certificate found here may be self-issued and trusted by an application.</span></span>

<span data-ttu-id="58e87-144">인증서 저장소에 대한 자세한 내용은 [인증서 저장소](/windows/desktop/secauthn/certificate-stores)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-144">For more information about certificate stores, see [Certificate Stores](/windows/desktop/secauthn/certificate-stores).</span></span>

### <a name="selecting-a-store"></a><span data-ttu-id="58e87-145">저장소 선택</span><span class="sxs-lookup"><span data-stu-id="58e87-145">Selecting a Store</span></span>

<span data-ttu-id="58e87-146">인증서를 저장할 위치는 서비스 또는 클라이언트가 실행되는 방법과 시기에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-146">Selecting where to store a certificate depends how and when the service or client runs.</span></span> <span data-ttu-id="58e87-147">다음과 같은 일반 규칙이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-147">The following general rules apply:</span></span>

- <span data-ttu-id="58e87-148">WCF 서비스가 Windows 서비스에 호스팅된 경우 **로컬 컴퓨터** 저장소를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-148">If the WCF service is hosted in a Windows service use the **local machine** store.</span></span> <span data-ttu-id="58e87-149">인증서를 로컬 컴퓨터 저장소에 설치하려면 관리자 권한이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-149">Note that administrator privileges are required to install certificates into the local machine store.</span></span>

- <span data-ttu-id="58e87-150">서비스 또는 클라이언트가 사용자 계정에서 실행되는 애플리케이션인 경우 **현재 사용자** 저장소를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-150">If the service or client is an application that runs under a user account, then use the **current user** store.</span></span>

### <a name="accessing-stores"></a><span data-ttu-id="58e87-151">저장소 액세스</span><span class="sxs-lookup"><span data-stu-id="58e87-151">Accessing Stores</span></span>

<span data-ttu-id="58e87-152">저장소는 컴퓨터에 있는 폴더처럼 ACL(액세스 제어 목록)에 의해 보호됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-152">Stores are protected by access control lists (ACLs), just like folders on a computer.</span></span> <span data-ttu-id="58e87-153">인터넷 정보 서비스 (IIS)에서 호스팅하는 서비스를 만들 때 ASP.NET 계정으로 ASP.NET 프로세스가 실행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-153">When creating a service hosted by Internet Information Services (IIS), the ASP.NET process runs under the ASP.NET account.</span></span> <span data-ttu-id="58e87-154">이 계정은 서비스에 사용되는 인증서가 들어 있는 저장소에 대한 액세스 권한이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-154">That account must have access to the store that contains the certificates a service uses.</span></span> <span data-ttu-id="58e87-155">각각의 주 저장소는 기본 액세스 목록으로 보호되지만, 목록을 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-155">Each of the major stores is protected with a default access list, but the lists can be modified.</span></span> <span data-ttu-id="58e87-156">저장소 액세스를 위한 개별 역할을 만들 경우 해당 역할에 액세스 권한을 부여해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-156">If you create a separate role to access a store, you must grant that role access permission.</span></span> <span data-ttu-id="58e87-157">WinHttpCertConfig.exe 도구를 사용하여 액세스 목록을 수정하는 방법에 대한 자세한 내용은 [방법: 개발 중 사용할 임시 인증서 만들기](how-to-create-temporary-certificates-for-use-during-development.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-157">To learn how to modify the access list using the WinHttpCertConfig.exe tool, see [How to: Create Temporary Certificates for Use During Development](how-to-create-temporary-certificates-for-use-during-development.md).</span></span>

## <a name="chain-trust-and-certificate-authorities"></a><span data-ttu-id="58e87-158">신뢰 체인 및 인증 기관</span><span class="sxs-lookup"><span data-stu-id="58e87-158">Chain Trust and Certificate Authorities</span></span>

<span data-ttu-id="58e87-159">인증서는 개별 인증서가 인증서를 발급한 CA에 연결되는 계층 구조에 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-159">Certificates are created in a hierarchy where each individual certificate is linked to the CA that issued the certificate.</span></span> <span data-ttu-id="58e87-160">이 링크는 CA의 인증서로 연결됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-160">This link is to the CA’s certificate.</span></span> <span data-ttu-id="58e87-161">그런 다음 CA의 인증서가 원래 CA의 인증서를 발급 한 CA에 연결 됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-161">The CA’s certificate then links to the CA that issued the original CA’s certificate.</span></span> <span data-ttu-id="58e87-162">이 프로세스는 루트 CA의 인증서에 도달할 때까지 반복됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-162">This process is repeated up until the Root CA’s certificate is reached.</span></span> <span data-ttu-id="58e87-163">루트 CA의 인증서는 본질적으로 신뢰할 수 있는 인증서입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-163">The Root CA’s certificate is inherently trusted.</span></span>

<span data-ttu-id="58e87-164">디지털 인증서는 *신뢰 체인*이라고도 하는 이 계층 구조를 사용하여 엔터티를 인증하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-164">Digital certificates are used to authenticate an entity by relying on this hierarchy, also called a *chain of trust*.</span></span> <span data-ttu-id="58e87-165">인증서를 두 번 클릭 한 다음 **인증서 경로** 탭을 클릭 하 여 MMC 스냅인을 통해 인증서의 체인을 볼 수 있습니다. 인증 기관에 대 한 인증서 체인을 가져오는 방법에 대 한 자세한 내용은 [방법: 서명을 확인 하는 데 사용 되는 인증 기관 인증서 체인 지정](specify-the-certificate-authority-chain-verify-signatures-wcf.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-165">You can view any certificate's chain using the MMC snap-in by double-clicking any certificate, then clicking the **Certificate Path** tab. For more information about importing certificate chains for a Certification authority, see [How to: Specify the Certificate Authority Certificate Chain Used to Verify Signatures](specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span></span>

> [!NOTE]
> <span data-ttu-id="58e87-166">신뢰할 수 있는 루트 기관 인증서 저장소에 발급자의 인증서를 넣어 발급자를 신뢰할 수 있는 루트 기관으로 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-166">Any issuer can be designated a trusted root authority by placing the issuer's certificate in the trusted root authority certificate store.</span></span>

### <a name="disabling-chain-trust"></a><span data-ttu-id="58e87-167">신뢰 체인을 사용하지 않도록 설정</span><span class="sxs-lookup"><span data-stu-id="58e87-167">Disabling Chain Trust</span></span>

<span data-ttu-id="58e87-168">새 서비스를 만들 때 신뢰할 수 있는 루트 인증서를 통해 발급되지 않은 인증서를 사용하거나 발급하는 인증서 자체가 신뢰할 수 있는 루트 인증 기관 저장소에 없을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-168">When creating a new service, you may be using a certificate that is not issued by a trusted root certificate, or the issuing certificate itself may not be in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="58e87-169">개발 용도로만 인증서에 대한 신뢰 체인을 검사하는 메커니즘을 일시적으로 사용하지 않도록 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-169">For development purposes only, you can temporarily disable the mechanism that checks the chain of trust for a certificate.</span></span> <span data-ttu-id="58e87-170">이 작업을 수행하려면 `CertificateValidationMode` 속성을 `PeerTrust` 또는 `PeerOrChainTrust`로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-170">To do this, set the `CertificateValidationMode` property to either `PeerTrust` or `PeerOrChainTrust`.</span></span> <span data-ttu-id="58e87-171">두 모드는 인증서가 자체 발급되거나(신뢰 피어) 신뢰 체인의 일부일 수 있음을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-171">Either mode specifies that the certificate can either be self-issued (peer trust) or part of a chain of trust.</span></span> <span data-ttu-id="58e87-172">다음 클래스에 대한 속성을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-172">You can set the property on any of the following classes.</span></span>

|<span data-ttu-id="58e87-173">클래스</span><span class="sxs-lookup"><span data-stu-id="58e87-173">Class</span></span>|<span data-ttu-id="58e87-174">속성</span><span class="sxs-lookup"><span data-stu-id="58e87-174">Property</span></span>|
|-----------|--------------|
|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|
|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|
|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|
|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential>|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A?displayProperty=nameWithType>|

<span data-ttu-id="58e87-175">구성을 사용하여 속성을 설정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-175">You can also set the property using configuration.</span></span> <span data-ttu-id="58e87-176">유효성 검사 모드를 지정하는 데 사용되는 요소는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-176">The following elements are used to specify the validation mode:</span></span>

- [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md)

- [\<peerAuthentication>](../../configure-apps/file-schema/wcf/peerauthentication-element.md)

- [\<messageSenderAuthentication>](../../configure-apps/file-schema/wcf/messagesenderauthentication-element.md)

## <a name="custom-authentication"></a><span data-ttu-id="58e87-177">사용자 지정 인증</span><span class="sxs-lookup"><span data-stu-id="58e87-177">Custom Authentication</span></span>

<span data-ttu-id="58e87-178">`CertificateValidationMode` 속성을 사용하여 인증서가 인증되는 방법을 사용자 지정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-178">The `CertificateValidationMode` property also enables you to customize how certificates are authenticated.</span></span> <span data-ttu-id="58e87-179">기본적으로 수준은 `ChainTrust`로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-179">By default, the level is set to `ChainTrust`.</span></span> <span data-ttu-id="58e87-180"><xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom> 값을 사용하려면 `CustomCertificateValidatorType` 특성을 인증서의 유효성을 검사하는 데 사용된 어셈블리 및 형식으로 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-180">To use the <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom> value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate.</span></span> <span data-ttu-id="58e87-181">사용자 지정 유효성 검사기를 만들려면 추상 <xref:System.IdentityModel.Selectors.X509CertificateValidator> 클래스에서 상속해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-181">To create a custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class.</span></span>

<span data-ttu-id="58e87-182">사용자 지정 인증자를 만들 때 재정의할 가장 중요한 메서드는 <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A> 메서드입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-182">When creating a custom authenticator, the most important method to override is the <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A> method.</span></span> <span data-ttu-id="58e87-183">사용자 지정 인증에 대한 예제는 [X.509 인증서 유효성 검사기](../samples/x-509-certificate-validator.md) 샘플을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-183">For an example of custom authentication, see the [X.509 Certificate Validator](../samples/x-509-certificate-validator.md) sample.</span></span> <span data-ttu-id="58e87-184">자세한 내용은 [사용자 지정 자격 증명 및 자격 증명 유효성 검사](../extending/custom-credential-and-credential-validation.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-184">For more information, see [Custom Credential and Credential Validation](../extending/custom-credential-and-credential-validation.md).</span></span>

## <a name="using-the-powershell-new-selfsignedcertificate-cmdlet-to-build-a-certificate-chain"></a><span data-ttu-id="58e87-185">PowerShell New-selfsignedcertificate Cmdlet을 사용 하 여 인증서 체인 빌드</span><span class="sxs-lookup"><span data-stu-id="58e87-185">Using the PowerShell New-SelfSignedCertificate Cmdlet to Build a Certificate Chain</span></span>

<span data-ttu-id="58e87-186">PowerShell New-selfsignedcertificate cmdlet은 x.509 인증서와 개인 키/공개 키 쌍을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-186">The PowerShell New-SelfSignedCertificate cmdlet creates X.509 certificates and private key/public key pairs.</span></span> <span data-ttu-id="58e87-187">프라이빗 키를 디스크에 저장한 다음 새 인증서를 발급하고 서명하여 체인 인증서의 계층 구조를 시뮬레이션할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-187">You can save the private key to disk and then use it to issue and sign new certificates, thus simulating a hierarchy of chained certificates.</span></span> <span data-ttu-id="58e87-188">Cmdlet은 서비스를 개발 하는 데 도움을 주기 위한 것 이며 실제 배포에 대 한 인증서를 만드는 데 사용 하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-188">The cmdlet is intended for use only as an aid when developing services and should never be used to create certificates for actual deployment.</span></span> <span data-ttu-id="58e87-189">WCF 서비스를 개발 하는 경우 다음 단계를 사용 하 여 New-selfsignedcertificate cmdlet을 사용 하 여 신뢰 체인을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-189">When developing a WCF service, use the following steps to build a chain of trust with the New-SelfSignedCertificate cmdlet.</span></span>

#### <a name="to-build-a-chain-of-trust-with-the-new-selfsignedcertificate-cmdlet"></a><span data-ttu-id="58e87-190">New-selfsignedcertificate cmdlet을 사용 하 여 신뢰 체인을 빌드하려면</span><span class="sxs-lookup"><span data-stu-id="58e87-190">To build a chain of trust with the New-SelfSignedCertificate cmdlet</span></span>

1. <span data-ttu-id="58e87-191">New-selfsignedcertificate cmdlet을 사용 하 여 임시 루트 인증 기관 (자체 서명) 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-191">Create a temporary root authority (self-signed) certificate using the New-SelfSignedCertificate cmdlet.</span></span> <span data-ttu-id="58e87-192">프라이빗 키를 디스크에 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-192">Save the private key to the disk.</span></span>

2. <span data-ttu-id="58e87-193">새 인증서를 사용하여 공개 키가 들어 있는 다른 인증서를 발급합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-193">Use the new certificate to issue another certificate that contains the public key.</span></span>

3. <span data-ttu-id="58e87-194">루트 기관 인증서를 신뢰할 수 있는 루트 인증 기관 저장소로 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-194">Import the root authority certificate into the Trusted Root Certification Authorities store.</span></span>

4. <span data-ttu-id="58e87-195">단계별 지침은 [방법: 개발 중 사용할 임시 인증서 만들기](how-to-create-temporary-certificates-for-use-during-development.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-195">For step-by-step instructions, see [How to: Create Temporary Certificates for Use During Development](how-to-create-temporary-certificates-for-use-during-development.md).</span></span>

## <a name="which-certificate-to-use"></a><span data-ttu-id="58e87-196">사용할 인증서</span><span class="sxs-lookup"><span data-stu-id="58e87-196">Which Certificate to Use?</span></span>

<span data-ttu-id="58e87-197">인증서에 대한 일반적인 질문은 사용할 인증서와 그 이유에 대한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-197">Common questions about certificates are which certificate to use, and why.</span></span> <span data-ttu-id="58e87-198">대답은 클라이언트를 프로그래밍하는지 서비스를 프로그래밍하는지에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-198">The answer depends on whether you are programming a client or service.</span></span> <span data-ttu-id="58e87-199">다음 정보에서는 일반적인 지침을 제공하며 이러한 질문에 대한 세부적인 대답은 아닙니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-199">The following information provides a general guideline and is not an exhaustive answer to these questions.</span></span>

### <a name="service-certificates"></a><span data-ttu-id="58e87-200">서비스 인증서</span><span class="sxs-lookup"><span data-stu-id="58e87-200">Service Certificates</span></span>

<span data-ttu-id="58e87-201">서비스 인증서의 주요 작업은 클라이언트에 서버를 인증하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-201">Service certificates have the primary task of authenticating the server to clients.</span></span> <span data-ttu-id="58e87-202">클라이언트에서 서버를 인증할 때 초기 검사 중 하나는 **주체** 필드의 값을 서비스를 연결하는 데 사용된 URI(Uniform Resource Identifier)와 비교하는 것입니다. 두 항목의 DNS가 일치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-202">One of the initial checks when a client authenticates a server is to compare the value of the **Subject** field to the Uniform Resource Identifier (URI) used to contact the service: the DNS of both must match.</span></span> <span data-ttu-id="58e87-203">예를 들어 서비스의 URI가 이면 `http://www.contoso.com/endpoint/` **제목** 필드에도 값이 포함 되어야 합니다 `www.contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="58e87-203">For example, if the URI of the service is `http://www.contoso.com/endpoint/` then the **Subject** field must also contain the value `www.contoso.com`.</span></span>

<span data-ttu-id="58e87-204">필드는 값을 나타내는 이니셜 접두사가 붙은 여러 값을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-204">Note that the field can contain several values, each prefixed with an initialization to indicate the value.</span></span> <span data-ttu-id="58e87-205">가장 일반적으로 초기화는 일반적인 이름에 대 한 "CN"입니다 (예:) `CN = www.contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="58e87-205">Most commonly, the initialization is "CN" for common name, for example, `CN = www.contoso.com`.</span></span> <span data-ttu-id="58e87-206">**주체** 필드를 비워둘 수도 있습니다. 이 경우 **주체 대체 이름** 필드는 **DNS 이름** 값을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-206">It is also possible for the **Subject** field to be blank, in which case the **Subject Alternative Name** field can contain the **DNS Name** value.</span></span>

<span data-ttu-id="58e87-207">또한 인증서의 **용도** 필드 값은 “서버 인증” 또는 “클라이언트 인증”과 같은 적절한 값을 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-207">Also note the value of the **Intended Purposes** field of the certificate should include an appropriate value, such as "Server Authentication" or "Client Authentication".</span></span>

### <a name="client-certificates"></a><span data-ttu-id="58e87-208">클라이언트 인증서</span><span class="sxs-lookup"><span data-stu-id="58e87-208">Client Certificates</span></span>

<span data-ttu-id="58e87-209">클라이언트 인증서는 일반적으로 타사 인증 기관에 의해 발급되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-209">Client certificates are not typically issued by a third-party certification authority.</span></span> <span data-ttu-id="58e87-210">대신 일반적으로 현재 사용자 위치의 개인 저장소에서 용도가 "클라이언트 인증"이고 루트 기관에서 넣은 인증서를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-210">Instead, the Personal store of the current user location typically contains certificates placed there by a root authority, with an intended purpose of "Client Authentication".</span></span> <span data-ttu-id="58e87-211">상호 인증이 필요한 경우 클라이언트에서 이러한 인증서를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-211">The client can use such a certificate when mutual authentication is required.</span></span>

## <a name="online-revocation-and-offline-revocation"></a><span data-ttu-id="58e87-212">온라인 해지 및 오프라인 해지</span><span class="sxs-lookup"><span data-stu-id="58e87-212">Online Revocation and Offline Revocation</span></span>

### <a name="certificate-validity"></a><span data-ttu-id="58e87-213">인증서 유효성</span><span class="sxs-lookup"><span data-stu-id="58e87-213">Certificate Validity</span></span>

<span data-ttu-id="58e87-214">모든 인증서는 *유효 기간*이라고 하는 지정된 기간 동안에만 유효합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-214">Every certificate is valid only for a given period of time, called the *validity period*.</span></span> <span data-ttu-id="58e87-215">유효 기간은 X.509 인증서의 **유효 기간(시작)** 및 **유효 기간(끝)** 필드에 의해 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-215">The validity period is defined by the **Valid from** and **Valid to** fields of an X.509 certificate.</span></span> <span data-ttu-id="58e87-216">인증 중에 인증서를 검사하여 인증서가 유효 기간 내에 있는지 여부를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-216">During authentication, the certificate is checked to determine whether the certificate is still within the validity period.</span></span>

### <a name="certificate-revocation-list"></a><span data-ttu-id="58e87-217">인증서 해지 목록</span><span class="sxs-lookup"><span data-stu-id="58e87-217">Certificate Revocation List</span></span>

<span data-ttu-id="58e87-218">인증 기관은 유효 기간 중에 언제든지 인증서를 해지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-218">At any time during the validity period, the certification authority can revoke a certificate.</span></span> <span data-ttu-id="58e87-219">인증서의 프라이빗 키 손상 등과 같은 다양한 이유로 인증서를 해지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-219">This can occur for many reasons, such as a compromise of the private key of the certificate.</span></span>

<span data-ttu-id="58e87-220">인증서를 해지하면 해지된 인증서 아래의 모든 체인도 유효하지 않으므로 인증 절차 중에 신뢰되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-220">When this occurs, any chains that descend from the revoked certificate are also invalid, and are not trusted during authentication procedures.</span></span> <span data-ttu-id="58e87-221">해지되는 인증서를 확인하기 위해 각 발급자는 타임스탬프 및 날짜 스탬프가 기록된 CRL(*인증서 해지 목록*)을 게시합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-221">To find out which certificates are revoked, each issuer publishes a time- and date-stamped *certificate revocation list* (CRL).</span></span> <span data-ttu-id="58e87-222">이 목록은 `RevocationMode`, `DefaultRevocationMode`, <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> 및 <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> 클래스의 <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication> 또는 <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication> 속성을 <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> 열거형 값 중 하나로 설정하여 온라인 해지 또는 오프라인 해지를 통해 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-222">The list can be checked using either online revocation or offline revocation by setting the `RevocationMode` or `DefaultRevocationMode` property of the following classes to one of the <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> enumeration values: <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>, <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>, and the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> classes.</span></span> <span data-ttu-id="58e87-223">모든 속성의 기본값은 `Online`입니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-223">The default value for all properties is `Online`.</span></span>

<span data-ttu-id="58e87-224">의 `revocationMode` [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) ( [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md) )와의 [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) () 특성을 사용 하 여 구성에서 모드를 설정할 수도 있습니다 [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md) .</span><span class="sxs-lookup"><span data-stu-id="58e87-224">You can also set the mode in configuration using the `revocationMode` attribute of both the [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md)) and the [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md)).</span></span>

## <a name="the-setcertificate-method"></a><span data-ttu-id="58e87-225">SetCertificate 메서드</span><span class="sxs-lookup"><span data-stu-id="58e87-225">The SetCertificate Method</span></span>

<span data-ttu-id="58e87-226">WCF에서는 서비스 또는 클라이언트에서 메시지를 인증, 암호화 또는 디지털 서명하는 데 사용할 인증서 또는 인증서 집합을 지정해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-226">In WCF, you must often specify a certificate or set of certificates a service or client is to use to authenticate, encrypt, or digitally sign a message.</span></span> <span data-ttu-id="58e87-227">이 작업은 X.509 인증서를 나타내는 다양한 클래스의 `SetCertificate` 메서드를 사용하여 프로그래밍 방식으로 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-227">You can do this programmatically by using the `SetCertificate` method of various classes that represent X.509 certificates.</span></span> <span data-ttu-id="58e87-228">다음 클래스에서는 `SetCertificate` 메서드를 사용하여 인증서를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-228">The following classes use the `SetCertificate` method to specify a certificate.</span></span>

|<span data-ttu-id="58e87-229">클래스</span><span class="sxs-lookup"><span data-stu-id="58e87-229">Class</span></span>|<span data-ttu-id="58e87-230">방법</span><span class="sxs-lookup"><span data-stu-id="58e87-230">Method</span></span>|
|-----------|------------|
|<xref:System.ServiceModel.Security.PeerCredential>|<xref:System.ServiceModel.Security.PeerCredential.SetCertificate%2A>|
|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential>|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A>|
|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential>|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential.SetCertificate%2A>|
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential>|
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A>|

<span data-ttu-id="58e87-231">`SetCertificate` 메서드는 저장소 위치 및 저장소, 인증서의 필드와 필드에서 찾을 값을 지정하는 "찾기" 형식(`x509FindType` 매개 변수)을 지정하여 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-231">The `SetCertificate` method works by designating a store location and store, a "find" type (`x509FindType` parameter) that specifies a field of the certificate, and a value to find in the field.</span></span> <span data-ttu-id="58e87-232">예를 들어, 다음 코드에서는 <xref:System.ServiceModel.ServiceHost> 인스턴스를 만들고 `SetCertificate` 메서드를 사용하여 클라이언트에 서비스를 인증하는 데 사용되는 서비스 인증서를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-232">For example, the following code creates a <xref:System.ServiceModel.ServiceHost> instance and sets the service certificate used to authenticate the service to clients with the `SetCertificate` method.</span></span>

[!code-csharp[c_WorkingWithCertificates#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_workingwithcertificates/cs/source.cs#1)]
[!code-vb[c_WorkingWithCertificates#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_workingwithcertificates/vb/source.vb#1)]

### <a name="multiple-certificates-with-the-same-value"></a><span data-ttu-id="58e87-233">동일한 값을 가진 여러 인증서</span><span class="sxs-lookup"><span data-stu-id="58e87-233">Multiple Certificates with the Same Value</span></span>

<span data-ttu-id="58e87-234">저장소에 동일한 주체 이름을 가진 여러 인증서가 들어 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-234">A store may contain multiple certificates with the same subject name.</span></span> <span data-ttu-id="58e87-235">즉, `x509FindType`을 <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> 또는 <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>으로 지정한 경우 동일한 값을 가진 여러 인증서가 있으면 필요한 인증서를 구별할 수 없으므로 예외가 throw됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-235">This means that if you specify that the `x509FindType` is <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> or <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>, and more than one certificate has the same value, an exception is thrown because there is no way to distinguish which certificate is required.</span></span> <span data-ttu-id="58e87-236">`x509FindType`을 <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>로 설정하여 이 문제를 완화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-236">You can mitigate this by setting the `x509FindType` to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>.</span></span> <span data-ttu-id="58e87-237">지문 필드에는 저장소에서 특정 인증서를 찾는 데 사용할 수 있는 고유한 값이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-237">The thumbprint field contains a unique value that can be used to find a specific certificate in a store.</span></span> <span data-ttu-id="58e87-238">그러나 인증서를 해지하거나 갱신하면 지문도 제거되므로 `SetCertificate` 메서드가 실패한다는 단점이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-238">However, this has its own disadvantage: if the certificate is revoked or renewed, the `SetCertificate` method fails because the thumbprint is also gone.</span></span> <span data-ttu-id="58e87-239">또는 인증서가 더 이상 유효하지 않을 경우 인증에 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-239">Or, if the certificate is no longer valid, authentication fails.</span></span> <span data-ttu-id="58e87-240">이 문제를 줄이려면 `x590FindType` 매개 변수를 <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName>으로 설정하고 발급자의 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-240">The way to mitigate this is to set the `x590FindType` parameter to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName> and specify the issuer's name.</span></span> <span data-ttu-id="58e87-241">특정 발급자가 필요하지 않은 경우 다른 <xref:System.Security.Cryptography.X509Certificates.X509FindType> 열거형 값 중 하나(예: <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>)를 설정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-241">If no particular issuer is required, you can also set one of the other <xref:System.Security.Cryptography.X509Certificates.X509FindType> enumeration values, such as <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>.</span></span>

## <a name="certificates-in-configuration"></a><span data-ttu-id="58e87-242">구성의 인증서</span><span class="sxs-lookup"><span data-stu-id="58e87-242">Certificates in Configuration</span></span>

<span data-ttu-id="58e87-243">구성을 사용하여 인증서를 설정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-243">You can also set certificates by using configuration.</span></span> <span data-ttu-id="58e87-244">서비스를 만드는 경우 인증서를 포함 한 자격 증명이에서 지정 됩니다 [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md) .</span><span class="sxs-lookup"><span data-stu-id="58e87-244">If you are creating a service, credentials, including certificates, are specified under the [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md).</span></span> <span data-ttu-id="58e87-245">클라이언트를 프로그래밍 하는 경우 인증서가에서 지정 됩니다 [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md) .</span><span class="sxs-lookup"><span data-stu-id="58e87-245">When you are programming a client, certificates are specified under the [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md).</span></span>

## <a name="mapping-a-certificate-to-a-user-account"></a><span data-ttu-id="58e87-246">사용자 계정에 인증서 매핑</span><span class="sxs-lookup"><span data-stu-id="58e87-246">Mapping a Certificate to a User Account</span></span>

<span data-ttu-id="58e87-247">IIS 및 Active Directory에는 Windows 사용자 계정에 인증서를 매핑하는 기능이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-247">A feature of IIS and Active Directory is the ability to map a certificate to a Windows user account.</span></span> <span data-ttu-id="58e87-248">기능에 대한 자세한 내용은 [사용자 계정에 인증서 매핑](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc736706(v=ws.10))을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-248">For more information about the feature, see [Map certificates to user accounts](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc736706(v=ws.10)).</span></span>

<span data-ttu-id="58e87-249">Active Directory 매핑 사용에 대한 자세한 내용은 [디렉터리 서비스 매핑을 사용하여 클라이언트 인증서 매핑](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc758484(v=ws.10))을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="58e87-249">For more information about using Active Directory mapping, see [Mapping Client Certificates with Directory Service Mapping](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc758484(v=ws.10)).</span></span>

<span data-ttu-id="58e87-250">이 기능을 사용하여 <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> 클래스의 <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> 속성을 `true`로 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-250">With this capability enabled, you can set the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> property of the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> class to `true`.</span></span> <span data-ttu-id="58e87-251">구성에서 `mapClientCertificateToWindowsAccount` [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) `true` 다음 코드에 표시 된 것 처럼 요소의 특성을로 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-251">In configuration, you can set the `mapClientCertificateToWindowsAccount` attribute of the [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element to `true`, as shown in the following code.</span></span>

```xml
<serviceBehaviors>
 <behavior name="MappingBehavior">
  <serviceCredentials>
   <clientCertificate>
    <authentication certificateValidationMode="None" mapClientCertificateToWindowsAccount="true" />
   </clientCertificate>
  </serviceCredentials>
 </behavior>
</serviceBehaviors>
```

<span data-ttu-id="58e87-252">Windows 사용자 계정을 나타내는 토큰에 X.509 인증서를 매핑하면 매핑된 Windows 토큰을 사용하여 보호된 리소스에 액세스할 수 있기 때문에 권한 상승으로 간주됩니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-252">Mapping an X.509 certificate to the token that represents a Windows user account is considered an elevation of privilege because, once mapped, the Windows token can be used to gain access to protected resources.</span></span> <span data-ttu-id="58e87-253">따라서 도메인 정책에서는 매핑 전에 X.509 인증서가 해당 정책을 준수하도록 요구합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-253">Therefore, domain policy requires the X.509 certificate to comply with its policy prior to mapping.</span></span> <span data-ttu-id="58e87-254">*SChannel* 보안 패키지는 이러한 요구 사항을 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-254">The *SChannel* security package enforces this requirement.</span></span>

<span data-ttu-id="58e87-255">.NET Framework 3.5 이상 버전을 사용 하는 경우 WCF는 인증서가 Windows 계정에 매핑되도록 도메인 정책을 준수 하는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-255">When using .NET Framework 3.5 or later versions, WCF ensures the certificate conforms to domain policy before it is mapped to a Windows account.</span></span>

<span data-ttu-id="58e87-256">WCF의 첫 번째 릴리스에서는 도메인 정책을 참조하지 않고 매핑을 수행했습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-256">In the first release of WCF, mapping is done without consulting the domain policy.</span></span> <span data-ttu-id="58e87-257">따라서 매핑을 실행할 때 X.509 인증서가 도메인 정책에 맞지 않을 경우 첫 번째 릴리스에서 작동했던 이전 애플리케이션이 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="58e87-257">Therefore it is possible that older applications that used to work when running under the first release, fails if the mapping is enabled and the X.509 certificate does not satisfy the domain policy.</span></span>

## <a name="see-also"></a><span data-ttu-id="58e87-258">참고 항목</span><span class="sxs-lookup"><span data-stu-id="58e87-258">See also</span></span>

- <xref:System.ServiceModel.Channels>
- <xref:System.ServiceModel.Security>
- <xref:System.ServiceModel>
- <xref:System.Security.Cryptography.X509Certificates.X509FindType>
- [<span data-ttu-id="58e87-259">서비스 및 클라이언트에 보안 설정</span><span class="sxs-lookup"><span data-stu-id="58e87-259">Securing Services and Clients</span></span>](securing-services-and-clients.md)
