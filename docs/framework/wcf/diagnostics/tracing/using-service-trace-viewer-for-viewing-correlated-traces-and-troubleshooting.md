---
title: Service Trace Viewer를 사용하여 상호 관련된 추적 보기 및 문제 해결
ms.date: 03/30/2017
ms.assetid: 05d2321c-8acb-49d7-a6cd-8ef2220c6775
ms.openlocfilehash: e1cd1443e96e7195127cb95e7ef1b2c4d6d9c176
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84587757"
---
# <a name="using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting"></a><span data-ttu-id="97e4d-102">Service Trace Viewer를 사용하여 상호 관련된 추적 보기 및 문제 해결</span><span class="sxs-lookup"><span data-stu-id="97e4d-102">Using Service Trace Viewer for Viewing Correlated Traces and Troubleshooting</span></span>

<span data-ttu-id="97e4d-103">이 항목에서는 추적 데이터 형식, 추적 데이터를 보는 방법 및 Service Trace Viewer를 사용하여 애플리케이션 문제를 해결하는 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-103">This topic describes the format of trace data, how to view it, and approaches that use the Service Trace Viewer to troubleshoot your application.</span></span>

## <a name="using-the-service-trace-viewer-tool"></a><span data-ttu-id="97e4d-104">Service Trace Viewer 도구 사용</span><span class="sxs-lookup"><span data-stu-id="97e4d-104">Using the Service Trace Viewer Tool</span></span>

<span data-ttu-id="97e4d-105">WCF (Windows Communication Foundation) 서비스 추적 뷰어 도구를 사용 하면 WCF 수신기에 의해 생성 된 진단 추적의 상관 관계를 파악 하 여 오류의 근본 원인을 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-105">The Windows Communication Foundation (WCF) Service Trace Viewer tool helps you correlate diagnostic traces produced by WCF listeners to locate the root cause of an error.</span></span> <span data-ttu-id="97e4d-106">이 도구를 사용 하면 WCF 서비스 문제를 진단, 복구 및 확인할 수 있도록 추적을 쉽게 보고 그룹화 하 고 필터링 하는 방법을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-106">The tool gives you a way to easily view, group, and filter traces so that you can diagnose, repair and verify issues with WCF services.</span></span> <span data-ttu-id="97e4d-107">이 도구를 사용 하는 방법에 대 한 자세한 내용은 [서비스 추적 뷰어 도구 (svctraceviewer.exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="97e4d-107">For more information about using this tool, see [Service Trace Viewer Tool (SvcTraceViewer.exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md).</span></span>

<span data-ttu-id="97e4d-108">이 항목에는 [서비스 추적 뷰어 도구 (svctraceviewer.exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md)를 사용 하 여 볼 때 [추적 및 메시지 로깅](../../samples/tracing-and-message-logging.md) 예제를 실행 하 여 생성 된 추적의 스크린샷이 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-108">This topic contains screenshots of traces generated by running the [Tracing and Message Logging](../../samples/tracing-and-message-logging.md) sample, when viewed using the [Service Trace Viewer Tool (SvcTraceViewer.exe)](../../service-trace-viewer-tool-svctraceviewer-exe.md).</span></span> <span data-ttu-id="97e4d-109">이 항목에서는 추적의 내용, 동작 및 상관 관계를 이해하는 방법과 문제 해결 시 많은 수의 추적을 분석하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-109">This topic demonstrates how to understand trace content, activities and their correlation, and how to analyze large numbers of traces when troubleshooting.</span></span>

## <a name="viewing-trace-content"></a><span data-ttu-id="97e4d-110">추적 내용 보기</span><span class="sxs-lookup"><span data-stu-id="97e4d-110">Viewing Trace Content</span></span>

<span data-ttu-id="97e4d-111">추적 이벤트에는 다음과 같은 가장 중요한 정보가 들어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-111">A trace event contains the following most significant information:</span></span>

- <span data-ttu-id="97e4d-112">동작 이름(설정된 경우)</span><span class="sxs-lookup"><span data-stu-id="97e4d-112">Activity name when set.</span></span>

- <span data-ttu-id="97e4d-113">내보내기 시간</span><span class="sxs-lookup"><span data-stu-id="97e4d-113">Emission time.</span></span>

- <span data-ttu-id="97e4d-114">추적 수준</span><span class="sxs-lookup"><span data-stu-id="97e4d-114">Trace level.</span></span>

- <span data-ttu-id="97e4d-115">추적 원본 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-115">Trace source name.</span></span>

- <span data-ttu-id="97e4d-116">프로세스 이름</span><span class="sxs-lookup"><span data-stu-id="97e4d-116">Process name.</span></span>

- <span data-ttu-id="97e4d-117">스레드 ID</span><span class="sxs-lookup"><span data-stu-id="97e4d-117">Thread id.</span></span>

- <span data-ttu-id="97e4d-118">추적에 관련 된 추가 정보를 얻을 수 있는 Microsoft Docs의 대상을 가리키는 URL 인 고유 추적 식별자입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-118">A unique trace identifier, which is a URL that points to a destination in Microsoft Docs, from which you can obtain more information related to the trace.</span></span>

 <span data-ttu-id="97e4d-119">이러한 모든 항목은 서비스 추적 뷰어의 오른쪽 위 패널 또는 추적을 선택할 때 오른쪽 아래 패널의 서식이 지정 된 보기에 있는 **기본 정보** 섹션에서 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-119">All of these can be seen in the upper right panel in the Service Trace Viewer, or in the **Basic Information** section in the formatted view of the lower-right panel when selecting a trace.</span></span>

> [!NOTE]
> <span data-ttu-id="97e4d-120">클라이언트와 서비스가 동일한 컴퓨터에 있는 경우 두 애플리케이션에 대한 추적이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-120">If the client and the service are on the same machine, the traces for both applications will be present.</span></span> <span data-ttu-id="97e4d-121">이러한 열은 **프로세스 이름** 열을 사용 하 여 필터링 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-121">These can be filtered using the **Process Name** column.</span></span>

<span data-ttu-id="97e4d-122">서식이 지정된 보기에서는 사용 가능한 경우 추적 및 추가 세부 정보에 대한 설명을 볼 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-122">In addition, the formatted view also provides a description for the trace and additional detailed information when available.</span></span> <span data-ttu-id="97e4d-123">추가 세부 정보에는 예외 형식 및 메시지, 호출 스택, 메시지 동작, 보낸 사람/받는 사람 필드 및 기타 예외 정보가 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-123">The latter can include exception type and message, call stacks, message action, from/to fields, and other exception information.</span></span>

<span data-ttu-id="97e4d-124">XML 보기에서 유용한 xml 태그는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-124">In the XML view, useful xml tags include the following:</span></span>

- <span data-ttu-id="97e4d-125">`<SubType>`(추적 수준).</span><span class="sxs-lookup"><span data-stu-id="97e4d-125">`<SubType>` (trace level).</span></span>

- <span data-ttu-id="97e4d-126">`<TimeCreated>`.</span><span class="sxs-lookup"><span data-stu-id="97e4d-126">`<TimeCreated>`.</span></span>

- <span data-ttu-id="97e4d-127">`<Source>`(추적 소스 이름).</span><span class="sxs-lookup"><span data-stu-id="97e4d-127">`<Source>` (trace source name).</span></span>

- <span data-ttu-id="97e4d-128">`<Correlation>`(동작 id는 추적을 내보낼 때 설정).</span><span class="sxs-lookup"><span data-stu-id="97e4d-128">`<Correlation>` (activity id set when emitting the trace).</span></span>

- <span data-ttu-id="97e4d-129">`<Execution>`(프로세스 및 스레드 id).</span><span class="sxs-lookup"><span data-stu-id="97e4d-129">`<Execution>` (process and thread id).</span></span>

- <span data-ttu-id="97e4d-130">`<Computer>`.</span><span class="sxs-lookup"><span data-stu-id="97e4d-130">`<Computer>`.</span></span>

- <span data-ttu-id="97e4d-131">`<ExtendedData>`을 포함 하 여, `<Action>` `<MessageID>` `<ActivityId>` 메시지를 보낼 때 메시지 헤더에 설정 된를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-131">`<ExtendedData>`, including `<Action>`, `<MessageID>` and the `<ActivityId>` set in the message header when sending a message.</span></span>

<span data-ttu-id="97e4d-132">"채널을 통해 메시지를 보냈습니다." 추적을 검사하면 다음 내용을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-132">If you examine the "Sent a message over a channel" trace, you may see the following content.</span></span>

```xml
<E2ETraceEvent xmlns="http://schemas.microsoft.com/2004/06/E2ETraceEvent">
   <System xmlns="http://schemas.microsoft.com/2004/06/windows/eventlog/system">
      <EventID>262163</EventID>
      <Type>3</Type>
      <SubType Name="Information">0</SubType>
      <Level>8</Level>
      <TimeCreated SystemTime="2006-08-04T18:45:30.8491051Z" />
      <Source Name="System.ServiceModel" />
       <Correlation ActivityID="{27c6331d-8998-43aa-a382-03239013a6bd}"/>
       <Execution ProcessName="client" ProcessID="1808" ThreadID="1" />
       <Channel />
       <Computer>TEST1</Computer>
   </System>
   <ApplicationData>
       <TraceData>
          <DataItem>
             <TraceRecord xmlns="http://schemas.microsoft.com/2004/10/E2ETraceEvent/TraceRecord" Severity="Information">
                 <TraceIdentifier>http://msdn.microsoft.com/library/System.ServiceModel.Channels.MessageSent.aspx</TraceIdentifier>
                 <Description>Sent a message over a channel.</Description>
                 <AppDomain>client.exe</AppDomain>
                 <Source>System.ServiceModel.Channels.ClientFramingDuplexSessionChannel/35191196</Source>
                <ExtendedData xmlns="http://schemas.microsoft.com/2006/08/ServiceModel/MessageTransmitTraceRecord">

                  <MessageProperties>
                     <AllowOutputBatching>False</AllowOutputBatching>
                  </MessageProperties>
                  <MessageHeaders>
                     <Action d4p1:mustUnderstand="1" xmlns:d4p1="http://www.w3.org/2003/05/soap-envelope" xmlns="http://www.w3.org/2005/08/addressing">http://Microsoft.ServiceModel.Samples/ICalculator/Multiply</Action>
                     <MessageID xmlns="http://www.w3.org/2005/08/addressing">urn:uuid:7c6670d8-4c9c-496e-b6a0-2ceb6db35338</MessageID>
                     <ActivityId CorrelationId="b02e2189-0816-4387-980c-dd8e306440f5" xmlns="http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics">27c6331d-8998-43aa-a382-03239013a6bd</ActivityId>
                     <ReplyTo xmlns="http://www.w3.org/2005/08/addressing">
                        <Address>http://www.w3.org/2005/08/addressing/anonymous</Address>
                    </ReplyTo>
                    <To d4p1:mustUnderstand="1" xmlns:d4p1="http://www.w3.org/2003/05/soap-envelope" xmlns="http://www.w3.org/2005/08/addressing">net.tcp://localhost/servicemodelsamples/service</To>
                  </MessageHeaders>
                  <RemoteAddress>net.tcp://localhost/servicemodelsamples/service</RemoteAddress>
                </ExtendedData>
            </TraceRecord>
          </DataItem>
       </TraceData>
   </ApplicationData>
</E2ETraceEvent>
```

## <a name="servicemodel-e2e-tracing"></a><span data-ttu-id="97e4d-133">ServiceModel E2E 추적</span><span class="sxs-lookup"><span data-stu-id="97e4d-133">ServiceModel E2E Tracing</span></span>

<span data-ttu-id="97e4d-134">`System.ServiceModel`추적 소스가 Off 이외의로 설정 된 경우 `switchValue` `ActivityTracing` wcf는 wcf 처리를 위한 작업 및 전송을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-134">When the `System.ServiceModel` trace source is set with a `switchValue` other than Off, and `ActivityTracing`, WCF creates activities and transfers for WCF processing.</span></span>

<span data-ttu-id="97e4d-135">동작은 해당 처리 단위와 관련된 모든 추적을 그룹화하는 논리적인 처리 단위입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-135">An activity is a logical unit of processing that groups all traces related to that processing unit.</span></span> <span data-ttu-id="97e4d-136">예를 들어 요청별로 하나의 동작을 정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-136">For example, you can define one activity for each request.</span></span> <span data-ttu-id="97e4d-137">전송은 엔드포인트 내의 동작 사이에 인과 관계를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-137">Transfers create a causal relationship between activities within endpoints.</span></span> <span data-ttu-id="97e4d-138">동작 ID를 전파하면 엔드포인트를 통해 동작을 서로 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-138">Propagating the activity ID enables you to relate activities across endpoints.</span></span> <span data-ttu-id="97e4d-139">이 작업은 `propagateActivity` = `true` 모든 끝점의 구성에서을 설정 하 여 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-139">This can be done by setting `propagateActivity`=`true` in configuration at every endpoint.</span></span> <span data-ttu-id="97e4d-140">동작, 전송 및 전파를 통해 오류 상관 관계를 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-140">Activities, transfers, and propagation allow you to perform error correlation.</span></span> <span data-ttu-id="97e4d-141">이 방법으로 오류에 대한 근본 원인을 신속하게 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-141">In this way, you can find the root cause of an error more quickly.</span></span>

<span data-ttu-id="97e4d-142">클라이언트에서 각 개체 모델 호출에 대해 하나의 WCF 작업 (예: Open ChannelFactory, Add, 나눗셈 등)이 만들어집니다. 각 작업 호출은 "Process Action" 작업에서 처리 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-142">On the client, one WCF activity is created for each object model call (for example, Open ChannelFactory, Add, Divide, and so on.) Each of the operation calls is processed in a "Process Action" activity.</span></span>

<span data-ttu-id="97e4d-143">[추적 및 메시지 로깅](../../samples/tracing-and-message-logging.md) 샘플에서 추출 된 다음 스크린샷에는 왼쪽 패널에 클라이언트 프로세스에서 만들어진 활동 목록이 생성 시간을 기준으로 정렬 되어 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-143">In the following screenshot, extracted from the [Tracing and Message Logging](../../samples/tracing-and-message-logging.md) sample the left panel displays the list of activities created in the client process, sorted by creation time.</span></span> <span data-ttu-id="97e4d-144">다음은 발생한 동작 순서 목록입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-144">The following is a chronological list of activities:</span></span>

- <span data-ttu-id="97e4d-145">채널 팩터리 생성(ClientBase)</span><span class="sxs-lookup"><span data-stu-id="97e4d-145">Constructed the channel factory (ClientBase).</span></span>

- <span data-ttu-id="97e4d-146">채널 팩터리 열기</span><span class="sxs-lookup"><span data-stu-id="97e4d-146">Opened the channel factory.</span></span>

- <span data-ttu-id="97e4d-147">작업 추가 처리</span><span class="sxs-lookup"><span data-stu-id="97e4d-147">Processed the Add action.</span></span>

- <span data-ttu-id="97e4d-148">보안 세션 설정(첫 번째 요청에서의 이 OCCURRED) 및 세 가지 보안 인프라 응답 메시지인 RST, RSTR, SCT(메시지 처리 1, 2, 3) 처리</span><span class="sxs-lookup"><span data-stu-id="97e4d-148">Set up the Secure Session (this OCCURRED on the first request) and processed three security infrastructure response messages: RST, RSTR, SCT (Process message 1, 2, 3).</span></span>

- <span data-ttu-id="97e4d-149">빼기, 곱하기 및 나누기 요청 처리</span><span class="sxs-lookup"><span data-stu-id="97e4d-149">Processed the Subtract, Multiply, and Divide requests.</span></span>

- <span data-ttu-id="97e4d-150">채널 팩터리 닫기, 보안 세션 닫기 및 보안 메시지 응답 취소 처리</span><span class="sxs-lookup"><span data-stu-id="97e4d-150">Closed the channel factory, and doing so closed the Secure session and processed the security message response Cancel.</span></span>

 <span data-ttu-id="97e4d-151">wsHttpBinding이 사용되기 때문에 보안 인프라 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-151">We see the security infrastructure messages because of the wsHttpBinding.</span></span>

> [!NOTE]
> <span data-ttu-id="97e4d-152">WCF에서는 요청 메시지를 포함 하는 해당 Process Action 작업을 전송 하 여 전송 하기 전에 처음에 개별 작업 (프로세스 메시지)에서 처리 되는 응답 메시지를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-152">In WCF, we show response messages being processed initially in a separate activity (Process message) before we correlate them to the corresponding Process Action activity that includes the request message, through a transfer.</span></span> <span data-ttu-id="97e4d-153">이는 인프라 메시지와 비동기 요청에 대해 발생하며, 그 이유는 메시지를 검사하고, activityId 헤더를 읽고, 이 ID를 갖는 기존의 Process Action 동작을 식별하여 서로 관련시켜야 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-153">This happens for infrastructure messages and asynchronous requests and is due to the fact that we must inspect the message, read the activityId header, and identify the existing Process Action activity with that id to correlate to it.</span></span> <span data-ttu-id="97e4d-154">동기 요청의 경우에는 응답을 차단하므로 응답이 어떤 Process Action과 연결되어 있는지 알 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-154">For synchronous requests, we are blocking for the response and hence know which Process action the response relates to.</span></span>

<span data-ttu-id="97e4d-155">다음 이미지는 만든 시간 (왼쪽 패널) 및 중첩 된 활동 및 추적 (오른쪽 위 패널)에 의해 나열 된 WCF 클라이언트 활동을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-155">The following image shows WCF client activities listed by creation time (left panel) and their nested activities and traces (upper right panel):</span></span>

![만든 시간별로 나열 된 WCF 클라이언트 활동을 보여 주는 스크린샷](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-client-activities-creation-time.gif)

<span data-ttu-id="97e4d-157">왼쪽 패널에서 동작을 선택하면 중첩된 동작과 추적이 오른쪽 위 패널에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-157">When we select an activity in the left panel, we can see nested activities and traces on the upper right panel.</span></span> <span data-ttu-id="97e4d-158">따라서 이 보기는 선택한 부모 동작을 기준으로 왼쪽에 동작 목록을 축소한 계층 구조 보기입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-158">Therefore, this is a reduced hierarchical view of the list of activities on the left, based on the selected parent activity.</span></span> <span data-ttu-id="97e4d-159">선택한 Process action Add가 첫 번째 요청이므로 이 동작에 Set Up Secure Session 동작(전송, 다시 전송)이 포함되며 추가 작업의 실제 처리를 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-159">Because the selected Process action Add is the first request made, this activity contains the Set Up Secure Session activity (transfer to, transfer back from), and traces for the actual processing of the Add action.</span></span>

<span data-ttu-id="97e4d-160">왼쪽 패널에서 동작 동작 추가 작업을 두 번 클릭 하면 추가와 관련 된 클라이언트 WCF 작업의 그래픽 표현을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-160">If we double click the Process action Add activity in the left panel, we can see a graphical representation of the client WCF activities related to Add.</span></span> <span data-ttu-id="97e4d-161">왼쪽의 첫 번째 동작은 기본 동작인 루트 동작(0000)입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-161">The first activity on the left is the root activity (0000), which is the default activity.</span></span> <span data-ttu-id="97e4d-162">WCF가 앰비언트 활동 외부로 전송 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-162">WCF transfers out of the ambient activity.</span></span> <span data-ttu-id="97e4d-163">이를 정의 하지 않으면 WCF가 0000에서 전송 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-163">If this is not defined, WCF transfers out of 0000.</span></span> <span data-ttu-id="97e4d-164">이때 두 번째 동작인 Process Action Add가 0에서 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-164">Here, the second activity, Process Action Add, transfers out of 0.</span></span> <span data-ttu-id="97e4d-165">그런 다음 Setup Secure Session이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-165">Then we see Setup Secure Session.</span></span>

<span data-ttu-id="97e4d-166">다음 이미지는 WCF 클라이언트 작업, 특히 앰비언트 작업 (0), 동작 처리 및 보안 세션 설정의 그래프 뷰를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-166">The following image shows a graph view of WCF client activities, specifically Ambient Activity (here 0), Process action, and Set Up Secure Session:</span></span>

![앰비언트 작업 및 프로세스 동작을 보여 주는 추적 뷰어의 그래프입니다.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-activities-graph-ambient-process.gif)

<span data-ttu-id="97e4d-168">오른쪽 위 패널에서 Process Action Add 동작과 관련된 추적이 모두 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-168">On the upper right panel, we can see all traces related to the Process Action Add activity.</span></span> <span data-ttu-id="97e4d-169">특히 같은 동작으로 요청 메시지("채널을 통해 메시지를 보냈습니다.")를 보내고 응답("채널을 통해 메시지를 받았습니다")을 받았습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-169">Specifically, we have sent the request message ("Sent a message over a channel") and received the response ("Received a message over a channel") in the same activity.</span></span> <span data-ttu-id="97e4d-170">다음 그래프에서 이를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-170">This is shown in the following graph.</span></span> <span data-ttu-id="97e4d-171">쉽게 구별할 수 있도록 Set up Secure Session 동작은 그래프에 축소되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-171">For clarity, the Set up Secure Session activity is collapsed in the graph.</span></span>

<span data-ttu-id="97e4d-172">다음 그림에서는 프로세스 동작 동작에 대 한 추적 목록을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-172">The following image shows a list of traces for the Process Action activity.</span></span> <span data-ttu-id="97e4d-173">요청을 보내고 동일한 활동에서 응답을 받습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-173">We send the request and receive the response in the same activity.</span></span>

![프로세스 동작 동작에 대 한 추적 목록을 보여 주는 추적 뷰어의 스크린샷](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/process-action-traces.gif)

<span data-ttu-id="97e4d-175">여기서는 명확 하 게 하기 위해 클라이언트 추적을 로드 하지만 서비스 추적 (수신 된 요청 메시지 및 보낸 응답 메시지)이 도구에 로드 되 고 `propagateActivity` 이로 설정 된 경우 `true.` 에는 이후 그림에 표시 된 것과 같은 작업에 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-175">Here, we load client traces only for clarity, but service traces (request message received and response message sent) appear in the same activity if they are also loaded in the tool and `propagateActivity` was set to `true.` This is shown in a later illustration.</span></span>

<span data-ttu-id="97e4d-176">서비스에서 활동 모델은 다음과 같이 WCF 개념에 매핑됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-176">On the service, the activity model maps to the WCF concepts as follows:</span></span>

1. <span data-ttu-id="97e4d-177">ServiceHost를 생성하고 엽니다. 이렇게 하면 보안의 경우 여러 호스트 관련 동작을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-177">We construct and open a ServiceHost (this may create several host-related activities, for instance, in the case of security).</span></span>

2. <span data-ttu-id="97e4d-178">Open ServiceHost 내부 및 외부로 전송하여 ServiceHost에서 각 수신기에 대한 Listen At 동작을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-178">We create a Listen At activity for each listener in the ServiceHost (with transfers in and out of Open ServiceHost).</span></span>

3. <span data-ttu-id="97e4d-179">수신기가 클라이언트에서 시작한 통신 요청을 감지 하면 클라이언트에서 보낸 모든 바이트가 처리 되는 "수신 바이트" 작업으로 전송 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-179">When the listener detects a communication request initiated by the client, it transfers to a "Receive Bytes" activity, in which all bytes sent from the client are processed.</span></span> <span data-ttu-id="97e4d-180">이 동작에서 클라이언트-서비스 상호 작용 중에 발생한 연결 오류가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-180">In this activity, we can see any connection errors that have happened during the client-service interaction.</span></span>

4. <span data-ttu-id="97e4d-181">메시지에 해당 하는 수신 되는 각 바이트 집합에 대해 "메시지 처리" 작업에서 이러한 바이트를 처리 합니다. 여기서 WCF 메시지 개체를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-181">For each set of bytes that is received that corresponds to a message, we process these bytes in a "Process Message" activity, where we create the WCF Message object.</span></span> <span data-ttu-id="97e4d-182">이 동작에서 악의적인 메시지 또는 잘못된 봉투와 관련된 오류가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-182">In this activity, we see errors related to a bad envelope or a malformed message.</span></span>

5. <span data-ttu-id="97e4d-183">메시지가 형성되면 Process Action 동작으로 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-183">Once the message is formed, we transfer to a Process Action activity.</span></span> <span data-ttu-id="97e4d-184">`propagateActivity`가 클라이언트와 서버에서 모두 `true`로 설정되는 경우 이 동작에는 클라이언트에서 정의되고 앞에서 설명한 것과 동일한 ID를 갖게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-184">If `propagateActivity` is set to `true` on both the client and service, this activity has the same id as the one defined in the client, and described previously.</span></span> <span data-ttu-id="97e4d-185">이 단계에서는 요청에 관련 된 WCF에서 내보낸 모든 추적이 응답 메시지 처리를 포함 하 여 동일한 활동에 있기 때문에 끝점 간 직접 상관 관계를 활용 하기 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-185">From this stage we start to benefit from direct correlation across endpoints, because all traces emitted in WCF that are related to the request are in that same activity, including the response message processing.</span></span>

6. <span data-ttu-id="97e4d-186">Out-of-process 작업의 경우 "사용자 코드 실행" 작업을 만들어 WCF에서 내보낸 사용자 코드에서 내보낸 추적을 격리 합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-186">For out-of-process action, we create an "Execute user code" activity to isolate traces emitted in user code from the ones emitted in WCF.</span></span> <span data-ttu-id="97e4d-187">위의 예제에서 "서비스는 추가 응답을 보냅니다." 추적은 해당 하는 경우 클라이언트에서 전파 하는 활동이 아닌 "사용자 코드 실행" 작업에서 내보내집니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-187">In the preceding example, the "Service sends Add response" trace is emitted in the "Execute User code" activity not in the activity propagated by the client, if applicable.</span></span>

<span data-ttu-id="97e4d-188">다음 그림에서 왼쪽의 첫 번째 동작은 기본 동작인 루트 동작(0000)입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-188">In the illustration that follows, the first activity on the left is the root activity (0000), which is the default activity.</span></span> <span data-ttu-id="97e4d-189">다음 세 동작은 ServiceHost를 여는 동작입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-189">The next three activities are to open the ServiceHost.</span></span> <span data-ttu-id="97e4d-190">열 5의 동작은 수신기이고, 나머지 동작(6 - 8)은 바이트 처리부터 사용자 코드 활성화까지 메시지를 처리하는 WCF입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-190">The activity in column 5 is the listener, and the remaining activities (6 to 8) describe the WCF processing of a message, from bytes processing to user code activation.</span></span>

<span data-ttu-id="97e4d-191">다음 이미지는 WCF 서비스 활동의 그래프 뷰를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-191">The following image shows a graph view of WCF service activities:</span></span>

![WCF 서비스 작업 목록을 보여 주는 추적 뷰어의 스크린샷](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-service-activities.gif)

<span data-ttu-id="97e4d-193">다음 스크린 샷에서는 클라이언트와 서비스 모두의 동작을 보여 주고 여러 프로세스에 걸쳐 Process Action Add 동작을 강조 표시합니다(주황색).</span><span class="sxs-lookup"><span data-stu-id="97e4d-193">The following screenshot shows the activities for both the client and service, and highlights the Process Action Add activity across processes (orange).</span></span> <span data-ttu-id="97e4d-194">화살표는 클라이언트와 서비스가 보내고 받은 요청 및 응답 메시지를 서로 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-194">Arrows relate the request and response messages sent and received by the client and service.</span></span> <span data-ttu-id="97e4d-195">Process Action의 추적이 그래프에서 프로세스 간에 구분되어 있지만 오른쪽 위 패널에 같은 동작의 일부로 표시되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-195">The traces of Process Action are separated across processes in the graph, but shown as part of the same activity in the upper-right panel.</span></span> <span data-ttu-id="97e4d-196">이 패널에서 보낸 메시지에 대한 클라이언트 추적을 확인한 다음 받고 처리한 메시지에 대한 서비스 추적을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-196">In this panel, we can see client traces for sent messages followed by service traces for received and processed messages.</span></span>

<span data-ttu-id="97e4d-197">다음 이미지는 WCF 클라이언트 및 서비스 작업의 그래프 뷰를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-197">The following images shows a graph view of both WCF client and service activities</span></span>

![WCF 클라이언트 및 서비스 활동을 모두 보여 주는 추적 뷰어의 그래프입니다.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/wcf-client-service-activities.gif)

<span data-ttu-id="97e4d-199">다음 오류 시나리오에서 서비스 및 클라이언트의 오류와 경고 추적이 서로 관련되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-199">In the following error scenario, error and warning traces at the service and client are related.</span></span> <span data-ttu-id="97e4d-200">예외가 서비스의 사용자 코드에서 먼저 throw됩니다("서비스가 사용자 코드에서 이 요청을 처리할 수 없습니다." 예외에 대한 경고 추적이 포함된 맨 오른쪽의 녹색 동작).</span><span class="sxs-lookup"><span data-stu-id="97e4d-200">An exception is first thrown in user code on the service (right-most green activity that includes a warning trace for the exception "The service cannot process this request in user code.").</span></span> <span data-ttu-id="97e4d-201">응답이 클라이언트에게 전송되면 오류 메시지를 표시하기 위해 경고 추적이 다시 내보내집니다(왼쪽의 분홍색 동작).</span><span class="sxs-lookup"><span data-stu-id="97e4d-201">When the response is sent to the client, a warning trace is again emitted to denote the fault message (left pink activity).</span></span> <span data-ttu-id="97e4d-202">그런 다음 클라이언트가 해당 WCF 클라이언트를 닫습니다(왼쪽 아래의 노란색 동작). 그러면 서비스에 대한 연결이 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-202">The client then closes its WCF client (yellow activity on the lower-left side), which aborts the connection to the service.</span></span> <span data-ttu-id="97e4d-203">서비스가 오류를 throw합니다(오른쪽의 가장 긴 분홍색 동작).</span><span class="sxs-lookup"><span data-stu-id="97e4d-203">The service throws an error (longest pink activity on the right).</span></span>

<span data-ttu-id="97e4d-204">![추적 뷰어 사용](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span><span class="sxs-lookup"><span data-stu-id="97e4d-204">![Using the Trace Viewer](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span></span>

<span data-ttu-id="97e4d-205">서비스와 클라이언트의 오류 상관 관계</span><span class="sxs-lookup"><span data-stu-id="97e4d-205">Error correlation across the service and client</span></span>

<span data-ttu-id="97e4d-206">이러한 추적을 생성하는 데 사용된 샘플은 wsHttpBinding을 사용하는 일련의 동기 요청입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-206">The sample used to generate these traces is a series of synchronous requests using the wsHttpBinding.</span></span> <span data-ttu-id="97e4d-207">보안을 사용하지 않거나 비동기 요청이 있는 시나리오의 경우 이 그래프에 차이가 있습니다. 여기서 Process Action 동작은 비동기 호출을 구성하는 시작 및 끝 작업을 포함하며 호출 동작에 대한 전송을 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-207">There are deviations from this graph for scenarios without security, or with asynchronous requests, where the Process Action activity encompasses the begin and end operations that constitute the asynchronous call, and shows transfers to a callback activity.</span></span> <span data-ttu-id="97e4d-208">추가 시나리오에 대 한 자세한 내용은 [종단 간 추적 시나리오](end-to-end-tracing-scenarios.md)를 참조 하십시오.</span><span class="sxs-lookup"><span data-stu-id="97e4d-208">For more information about additional scenarios, see [End-To-End Tracing Scenarios](end-to-end-tracing-scenarios.md).</span></span>

## <a name="troubleshooting-using-the-service-trace-viewer"></a><span data-ttu-id="97e4d-209">Service Trace Viewer를 사용하여 문제 해결</span><span class="sxs-lookup"><span data-stu-id="97e4d-209">Troubleshooting Using the Service Trace Viewer</span></span>

<span data-ttu-id="97e4d-210">Service Trace Viewer 도구에서 추적 파일을 로드하면 왼쪽 패널에서 빨간색 또는 노란색 동작을 선택하여 애플리케이션에서 문제의 원인을 추적할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-210">When you load trace files in the Service Trace Viewer Tool, you can select any red or yellow activity on the left panel to track down the cause of a problem in your application.</span></span> <span data-ttu-id="97e4d-211">000 동작에는 일반적으로 사용자에게 버블링되는 처리되지 않은 예외가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-211">The 000 activity typically has unhandled exceptions that bubble up to the user.</span></span>

<span data-ttu-id="97e4d-212">다음 이미지는 빨간색 또는 노란색 활동을 선택 하 여 문제의 근본를 찾는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-212">The following image shows how to select a red or yellow activity to locate the root of a problem.</span></span>
<span data-ttu-id="97e4d-213">![문제의 루트를 찾기 위한 빨강 또는 노랑 활동의 스크린샷](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/service-trace-viewer.gif)</span><span class="sxs-lookup"><span data-stu-id="97e4d-213">![Screenshot of red or yellow activities for locating the root of a problem.](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/service-trace-viewer.gif)</span></span>

<span data-ttu-id="97e4d-214">오른쪽 위 패널에서는 왼쪽에서 선택한 동작에 대한 추적을 검사할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-214">On the upper right panel, you can examine traces for the activity you selected on the left.</span></span> <span data-ttu-id="97e4d-215">그런 다음 이 패널에서 빨간색 또는 노란색 추적을 검사하고 이들 추적이 상호 연결된 방식을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-215">You can then examine red or yellow traces in that panel and see how they are correlated.</span></span> <span data-ttu-id="97e4d-216">앞의 그래프에서는 동일한 Process Action 동작에서 클라이언트와 서비스 모두에 대한 경고 추적을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-216">In the preceding graph, we see warning traces both for the client and service in the same Process Action activity.</span></span>

<span data-ttu-id="97e4d-217">이러한 추적이 오류의 근본 원인을 제공하지 않으면 왼쪽 패널에서 선택한 동작(여기서는 Process action)을 두 번 클릭하여 그래프를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-217">If these traces do not provide you with the root cause of the error, you can utilize the graph by double-clicking the selected activity on the left panel (here Process action).</span></span> <span data-ttu-id="97e4d-218">그러면 관련된 동작이 있는 그래프가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-218">The graph with related activities is then displayed.</span></span> <span data-ttu-id="97e4d-219">그런 다음 "+" 기호를 클릭 하 여 관련 된 작업을 확장 하 여 관련 작업에서 첫 번째 내보낸 추적을 빨간색 이나 노란색으로 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-219">You can then expand related activities (by clicking the "+" signs) to find the first emitted trace in red or yellow in a related activity.</span></span> <span data-ttu-id="97e4d-220">문제의 근본 원인을 추적할 때까지 빨간색 또는 노란색 추적 바로 전에 발생한 동작을 계속 확장하면서 관련된 동작이나 엔드포인트 간의 메시지 흐름으로의 전송을 살펴 봅니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-220">Keep expanding the activities that happened just before the red or yellow trace of interest, following transfers to related activities or message flows across endpoints, until you track the root cause of the problem.</span></span>

<span data-ttu-id="97e4d-221">![추적 뷰어 사용](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span><span class="sxs-lookup"><span data-stu-id="97e4d-221">![Using the Trace Viewer](media/wcfc-e2etrace9s.gif "wcfc_e2etrace9s")</span></span>

<span data-ttu-id="97e4d-222">동작을 확장하여 문제의 근본 원인 추적</span><span class="sxs-lookup"><span data-stu-id="97e4d-222">Expanding activities to track the root cause of a problem</span></span>

<span data-ttu-id="97e4d-223">ServiceModel `ActivityTracing`이 해제되어 있지만 ServiceModel 추적이 설정된 경우 0000 동작에 내보낸 ServiceModel 추적을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-223">If ServiceModel `ActivityTracing` is off but ServiceModel tracing is on, you can see ServiceModel traces emitted in the 0000 activity.</span></span> <span data-ttu-id="97e4d-224">하지만 이렇게 하려면 이러한 추적의 상관 관계를 이해해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-224">However, this requires more effort to understand the correlation of these traces.</span></span>

<span data-ttu-id="97e4d-225">메시지 로깅을 사용하도록 설정된 경우 메시지 탭을 사용하여 오류의 영향을 받는 메시지를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-225">If Message Logging is enabled, you can use the Message Tab to see which message is impacted by the error.</span></span> <span data-ttu-id="97e4d-226">빨간색 또는 노란색 메시지를 두 번 클릭하여 관련 동작에 대한 그래프 보기를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-226">By double-clicking a message in red or yellow, you can see the graph view of the related activities.</span></span> <span data-ttu-id="97e4d-227">이러한 동작은 오류가 발생한 요청과 가장 관련이 높은 동작입니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-227">These activities are the ones most closely related to the request where an error happened.</span></span>

![메시지 로깅을 사용 하도록 설정 된 추적 뷰어 스크린샷](./media/using-service-trace-viewer-for-viewing-correlated-traces-and-troubleshooting/message-logging-enabled.gif)

<span data-ttu-id="97e4d-229">문제 해결을 시작 하려면 빨간색 또는 노란색 메시지 추적을 선택 하 고 두 번 클릭 하 여 근본 원인을 추적 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="97e4d-229">To start troubleshooting, you can also pick a red or yellow message trace and double click it to track the root cause.</span></span>

## <a name="see-also"></a><span data-ttu-id="97e4d-230">참고 항목</span><span class="sxs-lookup"><span data-stu-id="97e4d-230">See also</span></span>

- [<span data-ttu-id="97e4d-231">엔드투엔드 추적 시나리오</span><span class="sxs-lookup"><span data-stu-id="97e4d-231">End-To-End Tracing Scenarios</span></span>](end-to-end-tracing-scenarios.md)
- [<span data-ttu-id="97e4d-232">Service Trace Viewer 도구(SvcTraceViewer.exe)</span><span class="sxs-lookup"><span data-stu-id="97e4d-232">Service Trace Viewer Tool (SvcTraceViewer.exe)</span></span>](../../service-trace-viewer-tool-svctraceviewer-exe.md)
- [<span data-ttu-id="97e4d-233">추적</span><span class="sxs-lookup"><span data-stu-id="97e4d-233">Tracing</span></span>](index.md)
