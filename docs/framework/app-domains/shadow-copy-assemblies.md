---
title: 어셈블리 섀도 복사
description: 애플리케이션 도메인을 언로드하지 않고 애플리케이션 도메인에서 사용되는 어셈블리를 업데이트할 수 있도록 하는 .NET의 어셈블리 섀도 복사를 살펴봅니다.
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies [.NET Framework], shadow copying
- application domains, shadow copying assemblies
- shadow copying assemblies
ms.assetid: de8b8759-fca7-4260-896b-5a4973157672
ms.openlocfilehash: a7ff72763dd26dbc50cd37e070c2d25ababa00f3
ms.sourcegitcommit: 1c37a894c923bea021a3cc38ce7cba946357bbe1
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/19/2020
ms.locfileid: "85104555"
---
# <a name="shadow-copying-assemblies"></a><span data-ttu-id="628ad-103">어셈블리 섀도 복사</span><span class="sxs-lookup"><span data-stu-id="628ad-103">Shadow Copying Assemblies</span></span>

<span data-ttu-id="628ad-104">섀도 복사를 사용하면 애플리케이션 도메인을 언로드하지 않고 애플리케이션 도메인에서 사용되는 어셈블리를 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-104">Shadow copying enables assemblies that are used in an application domain to be updated without unloading the application domain.</span></span> <span data-ttu-id="628ad-105">특히 이 기능은 ASP.NET 사이트와 같이 지속적으로 제공되어야 하는 애플리케이션에 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-105">This is particularly useful for applications that must be available continuously, such as ASP.NET sites.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="628ad-106">섀도 복사는 Windows 8.x 스토어 앱에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-106">Shadow copying is not supported in Windows 8.x Store apps.</span></span>

<span data-ttu-id="628ad-107">어셈블리가 로드될 때 공용 언어 런타임은 어셈블리 파일을 잠그므로 어셈블리가 언로드될 때까지 파일을 업데이트할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-107">The common language runtime locks an assembly file when the assembly is loaded, so the file cannot be updated until the assembly is unloaded.</span></span> <span data-ttu-id="628ad-108">애플리케이션 도메인에서 어셈블리를 언로드하는 유일한 방법은 애플리케이션 도메인을 언로드하는 것이므로 일반적인 환경에서는 어셈블리를 사용 중인 모든 애플리케이션 도메인이 언로드될 때까지 디스크에서 어셈블리를 업데이트할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-108">The only way to unload an assembly from an application domain is by unloading the application domain, so under normal circumstances, an assembly cannot be updated on disk until all the application domains that are using it have been unloaded.</span></span>

<span data-ttu-id="628ad-109">섀도 복사 파일에 대한 애플리케이션 도메인을 구성하면 애플리케이션 경로의 어셈블리가 다른 위치로 복사되고 해당 위치에서 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-109">When an application domain is configured to shadow copy files, assemblies from the application path are copied to another location and loaded from that location.</span></span> <span data-ttu-id="628ad-110">복사본이 잠기지만 원래 어셈블리 파일은 잠금 해제되므로 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-110">The copy is locked, but the original assembly file is unlocked and can be updated.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="628ad-111">섀도 복사될 수 있는 유일한 어셈블리는 애플리케이션 도메인이 구성될 때 <xref:System.AppDomainSetup.ApplicationBase%2A> 및 <xref:System.AppDomainSetup.PrivateBinPath%2A> 속성으로 지정된 애플리케이션 디렉터리나 하위 디렉터리에 저장된 어셈블리입니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-111">The only assemblies that can be shadow copied are those stored in the application directory or its subdirectories, specified by the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> properties when the application domain is configured.</span></span> <span data-ttu-id="628ad-112">전역 어셈블리 캐시에 저장된 어셈블리는 섀도 복사되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-112">Assemblies stored in the global assembly cache are not shadow copied.</span></span>

<span data-ttu-id="628ad-113">이 자료에는 다음과 같은 섹션이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-113">This article contains the following sections:</span></span>

- <span data-ttu-id="628ad-114">[섀도 복사 설정 및 사용](#EnablingAndUsing)에서는 섀도 복사에 대해 사용할 수 있는 기본 사용 및 옵션에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-114">[Enabling and Using Shadow Copying](#EnablingAndUsing) describes the basic use and the options that are available for shadow copying.</span></span>

- <span data-ttu-id="628ad-115">[시작 성능](#StartupPerformance)에서는 시작 성능을 개선하려고 .NET Framework 4에서 섀도 복사에 적용된 변경 내용과 이전 버전의 동작으로 되돌리는 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-115">[Startup Performance](#StartupPerformance) describes the changes that are made to shadow copying in the .NET Framework 4 to improve startup performance, and how to revert to the behavior of earlier versions.</span></span>

- <span data-ttu-id="628ad-116">[사용되지 않는 메서드](#ObsoleteMethods)에서는 .NET Framework 2.0에서 섀도 복사를 제어하는 속성 및 메서드의 변경 내용을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-116">[Obsolete Methods](#ObsoleteMethods) describes the changes that were made to the properties and methods that control shadow copying in the .NET Framework 2.0.</span></span>

<a name="EnablingAndUsing"></a>

## <a name="enabling-and-using-shadow-copying"></a><span data-ttu-id="628ad-117">섀도 복사 설정 및 사용</span><span class="sxs-lookup"><span data-stu-id="628ad-117">Enabling and Using Shadow Copying</span></span>

<span data-ttu-id="628ad-118">다음과 같이 <xref:System.AppDomainSetup> 클래스의 속성을 사용하여 섀도 복사를 사용하도록 애플리케이션을 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-118">You can use the properties of the <xref:System.AppDomainSetup> class as follows to configure an application domain for shadow copying:</span></span>

- <span data-ttu-id="628ad-119"><xref:System.AppDomainSetup.ShadowCopyFiles%2A> 속성을 `"true"` 문자열 값으로 설정하여 섀도 복사를 사용하도록 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-119">Enable shadow copying by setting the <xref:System.AppDomainSetup.ShadowCopyFiles%2A> property to the string value `"true"`.</span></span>

  <span data-ttu-id="628ad-120">기본적으로 이렇게 설정하면 애플리케이션 경로의 모든 어셈블리가 로드되기 전에 다운로드 캐시로 복사됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-120">By default, this setting causes all assemblies in the application path to be copied to a download cache before they are loaded.</span></span> <span data-ttu-id="628ad-121">이는 다른 컴퓨터에서 다운로드된 파일을 저장하도록 공용 언어 런타임에서 유지 관리되는 것과 같은 캐시이고, 공용 언어 런타임에서는 더 이상 필요하지 않을 때 자동으로 파일을 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-121">This is the same cache maintained by the common language runtime to store files downloaded from other computers, and the common language runtime automatically deletes the files when they are no longer needed.</span></span>

- <span data-ttu-id="628ad-122">선택적으로 <xref:System.AppDomainSetup.CachePath%2A> 속성과 <xref:System.AppDomainSetup.ApplicationName%2A> 속성을 사용하여 섀도 복사된 파일의 사용자 지정 위치를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-122">Optionally set a custom location for shadow copied files by using the <xref:System.AppDomainSetup.CachePath%2A> property and the <xref:System.AppDomainSetup.ApplicationName%2A> property.</span></span>

  <span data-ttu-id="628ad-123">위치의 기본 경로는 <xref:System.AppDomainSetup.ApplicationName%2A> 속성을 <xref:System.AppDomainSetup.CachePath%2A> 속성에 연결하여 하위 디렉터리로 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-123">The base path for the location is formed by concatenating the <xref:System.AppDomainSetup.ApplicationName%2A> property to the <xref:System.AppDomainSetup.CachePath%2A> property as a subdirectory.</span></span> <span data-ttu-id="628ad-124">어셈블리는 기본 경로 자체가 아니라 이 경로의 하위 디렉터리로 섀도 복사됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-124">Assemblies are shadow copied to subdirectories of this path, not to the base path itself.</span></span>

  > [!NOTE]
  > <span data-ttu-id="628ad-125"><xref:System.AppDomainSetup.ApplicationName%2A> 속성이 설정되지 않으면 <xref:System.AppDomainSetup.CachePath%2A> 속성이 무시되고 다운로드 캐시가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-125">If the <xref:System.AppDomainSetup.ApplicationName%2A> property is not set, the <xref:System.AppDomainSetup.CachePath%2A> property is ignored and the download cache is used.</span></span> <span data-ttu-id="628ad-126">예외가 throw되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-126">No exception is thrown.</span></span>

  <span data-ttu-id="628ad-127">사용자 지정 위치를 지정하면 더 이상 필요하지 않은 디렉터리 및 복사된 파일을 정리해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-127">If you specify a custom location, you are responsible for cleaning up the directories and copied files when they are no longer needed.</span></span> <span data-ttu-id="628ad-128">이들 항목은 자동으로 삭제되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-128">They are not deleted automatically.</span></span>

  <span data-ttu-id="628ad-129">섀도 복사된 파일의 사용자 지정 위치를 설정해야 하는 할 수 있는 몇 가지 이유가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-129">There are a few reasons why you might want to set a custom location for shadow copied files.</span></span> <span data-ttu-id="628ad-130">애플리케이션에서 많은 복사본을 생성하면 섀도 복사된 파일의 사용자 지정 위치를 설정해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-130">You might want to set a custom location for shadow copied files if your application generates a large number of copies.</span></span> <span data-ttu-id="628ad-131">다운로드 캐시는 수명이 아니라 크기별로 제한되므로 공용 언어 런타임이 사용 중인 파일을 삭제하려고 시도할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-131">The download cache is limited by size, not by lifetime, so it is possible that the common language runtime will attempt to delete a file that is still in use.</span></span> <span data-ttu-id="628ad-132">사용자 지정 위치를 설정하는 또 다른 이유는 애플리케이션을 실행하는 사용자가 공용 언어 런타임에서 다운로드 캐시에 사용하는 디렉터리 위치에 대한 쓰기 권한이 없는 경우입니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-132">Another reason to set a custom location is when users running your application do not have write access to the directory location the common language runtime uses for the download cache.</span></span>

- <span data-ttu-id="628ad-133">선택적으로 <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> 속성을 사용하여 섀도 복사되는 어셈블리를 제한합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-133">Optionally limit the assemblies that are shadow copied by using the <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> property.</span></span>

  <span data-ttu-id="628ad-134">애플리케이션 도메인에 대해 섀도 복사를 사용하도록 설정하면 기본적으로 애플리케이션 경로(<xref:System.AppDomainSetup.ApplicationBase%2A> 및 <xref:System.AppDomainSetup.PrivateBinPath%2A> 속성을 통해 지정된 디렉터리)의 모든 어셈블리가 복사됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-134">When you enable shadow copying for an application domain, the default is to copy all assemblies in the application path — that is, in the directories specified by the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> properties.</span></span> <span data-ttu-id="628ad-135">섀도 복사할 디렉터리만 포함된 문자열을 만들고 문자열을 <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> 속성에 할당하여 복사를 선택된 디렉터리로 제한할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-135">You can limit the copying to selected directories by creating a string that contains only those directories you want to shadow copy, and assigning the string to the <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> property.</span></span> <span data-ttu-id="628ad-136">디렉터리는 세미콜론으로 구분합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-136">Separate the directories with semicolons.</span></span> <span data-ttu-id="628ad-137">선택된 디렉터리의 어셈블리만 섀도 복사됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-137">The only assemblies that are shadow copied are the ones in the selected directories.</span></span>

  > [!NOTE]
  > <span data-ttu-id="628ad-138"><xref:System.AppDomainSetup.ShadowCopyDirectories%2A> 속성에 문자열을 할당하거나 이 속성을 `null`로 설정하면 <xref:System.AppDomainSetup.ApplicationBase%2A> 및 <xref:System.AppDomainSetup.PrivateBinPath%2A> 속성을 통해 지정된 디렉터리의 모든 어셈블리가 섀도 복사됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-138">If you don’t assign a string to the <xref:System.AppDomainSetup.ShadowCopyDirectories%2A> property, or if you set this property to `null`, all assemblies in the directories specified by the <xref:System.AppDomainSetup.ApplicationBase%2A> and <xref:System.AppDomainSetup.PrivateBinPath%2A> properties are shadow copied.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="628ad-139">세미콜론은 구분 기호 문자이므로 디렉터리 경로에 세미콜론을 포함하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-139">Directory paths must not contain semicolons, because the semicolon is the delimiter character.</span></span> <span data-ttu-id="628ad-140">세미콜론에 대한 이스케이프 문자는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-140">There is no escape character for semicolons.</span></span>

<a name="StartupPerformance"></a>

## <a name="startup-performance"></a><span data-ttu-id="628ad-141">시작 성능</span><span class="sxs-lookup"><span data-stu-id="628ad-141">Startup Performance</span></span>

<span data-ttu-id="628ad-142">섀도 복사를 사용하는 애플리케이션 도메인이 시작될 때 애플리케이션 디렉터리의 어셈블리가 섀도 복사 디렉터리로 복사되거나 이미 해당 위치에 있는지 확인되는 동안 지연이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-142">When an application domain that uses shadow copying starts, there is a delay while assemblies in the application directory are copied to the shadow copy directory, or verified if they are already in that location.</span></span> <span data-ttu-id="628ad-143">.NET Framework 4 이전에는 모든 어셈블리가 임시 디렉터리로 복사되었습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-143">Before the .NET Framework 4, all assemblies were copied to a temporary directory.</span></span> <span data-ttu-id="628ad-144">각 어셈블리를 열어 어셈블리 이름을 확인하고 강력한 이름의 유효성을 검사했습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-144">Each assembly was opened to verify the assembly name, and the strong name was validated.</span></span> <span data-ttu-id="628ad-145">각 어셈블리가 섀도 복사 디렉터리의 복사본보다 더 최근에 업데이트되었는지를 확인했습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-145">Each assembly was checked to see whether it had been updated more recently than the copy in the shadow copy directory.</span></span> <span data-ttu-id="628ad-146">그럴 경우 섀도 복사 디렉터리로 복사되었습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-146">If so, it was copied to the shadow copy directory.</span></span> <span data-ttu-id="628ad-147">마지막으로 임시 복사본이 삭제되었습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-147">Finally, the temporary copies were discarded.</span></span>

<span data-ttu-id="628ad-148">.NET Framework 4부터 기본 시작 동작은 애플리케이션 디렉터리에 있는 각 어셈블리의 파일 날짜 및 시간을 섀도 복사 디렉터리에 있는 복사본의 파일 날짜 및 시간과 직접 비교하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-148">Beginning with the .NET Framework 4, the default startup behavior is to directly compare the file date and time of each assembly in the application directory with the file date and time of the copy in the shadow copy directory.</span></span> <span data-ttu-id="628ad-149">어셈블리가 업데이트되었으면 .NET Framework의 이전 버전에서와 같은 절차를 사용하여 복사되고, 그러지 않으면 섀도 복사 디렉터리의 복사본이 로드됩니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-149">If the assembly has been updated, it is copied by using the same procedure as in earlier versions of the .NET Framework; otherwise, the copy in the shadow copy directory is loaded.</span></span>

<span data-ttu-id="628ad-150">어셈블리가 자주 변경되지 않고 대개 어셈블리의 작은 하위 집합에서 변경이 발생하는 애플리케이션에 대한 결과 성능 향상이 가장 큽니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-150">The resulting performance improvement is largest for applications in which assemblies do not change frequently and changes usually occur in a small subset of assemblies.</span></span> <span data-ttu-id="628ad-151">애플리케이션의 대부분 어셈블리가 자주 변경되면 새로운 기본 동작 때문에 성능이 저하될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-151">If a majority of assemblies in an application change frequently, the new default behavior might cause a performance regression.</span></span> <span data-ttu-id="628ad-152">[\<shadowCopyVerifyByTimestamp> 요소](../configure-apps/file-schema/runtime/shadowcopyverifybytimestamp-element.md)를 `enabled="false"`로 구성 파일에 추가하여 이전 버전 .NET Framework의 시작 동작을 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-152">You can restore the startup behavior of previous versions of the .NET Framework by adding the [\<shadowCopyVerifyByTimestamp> element](../configure-apps/file-schema/runtime/shadowcopyverifybytimestamp-element.md) to the configuration file, with `enabled="false"`.</span></span>

<a name="ObsoleteMethods"></a>

## <a name="obsolete-methods"></a><span data-ttu-id="628ad-153">사용되지 않는 메서드</span><span class="sxs-lookup"><span data-stu-id="628ad-153">Obsolete Methods</span></span>

<span data-ttu-id="628ad-154"><xref:System.AppDomain> 클래스에는 애플리케이션 도메인에서 섀도 복사를 제어하는 데 사용될 수 있는 <xref:System.AppDomain.SetShadowCopyFiles%2A> 및 <xref:System.AppDomain.ClearShadowCopyPath%2A>와 같은 여러 가지 메서드가 있지만 이들 메서드는 .NET Framework 버전 2.0에서 사용되지 않는 것으로 표시되었습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-154">The <xref:System.AppDomain> class has several methods, such as <xref:System.AppDomain.SetShadowCopyFiles%2A> and <xref:System.AppDomain.ClearShadowCopyPath%2A>, that can be used to control shadow copying on an application domain, but these have been marked obsolete in the .NET Framework version 2.0.</span></span> <span data-ttu-id="628ad-155">섀도 복사를 사용하도록 애플리케이션 도메인을 구성할 경우 <xref:System.AppDomainSetup> 클래스의 속성을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="628ad-155">The recommended way to configure an application domain for shadow copying is to use the properties of the <xref:System.AppDomainSetup> class.</span></span>

## <a name="see-also"></a><span data-ttu-id="628ad-156">참조</span><span class="sxs-lookup"><span data-stu-id="628ad-156">See also</span></span>

- <xref:System.AppDomainSetup.ShadowCopyFiles%2A?displayProperty=nameWithType>
- <xref:System.AppDomainSetup.CachePath%2A?displayProperty=nameWithType>
- <xref:System.AppDomainSetup.ApplicationName%2A?displayProperty=nameWithType>
- <xref:System.AppDomainSetup.ShadowCopyDirectories%2A?displayProperty=nameWithType>
- [<span data-ttu-id="628ad-157">\<shadowCopyVerifyByTimestamp> 요소</span><span class="sxs-lookup"><span data-stu-id="628ad-157">\<shadowCopyVerifyByTimestamp> Element</span></span>](../configure-apps/file-schema/runtime/shadowcopyverifybytimestamp-element.md)
